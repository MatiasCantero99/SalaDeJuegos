import{b as qr,c as Hr,f as wl,g as Gr}from"./chunk-SZXJF6TW.js";import{$,A as jt,Aa as Mr,B as In,Ba as We,C as gr,Ca as Or,D as Pn,Da as Ir,E as yr,Ea as Pr,F as C,G as O,Ga as Fr,H as _r,Ha as Rr,I as vr,Ia as Nr,J as wr,Ja as Vr,K as Fn,Ka as jr,L as Lt,La as Lr,M as $t,Ma as Di,N as Le,Na as $r,O as Z,Oa as Ur,P as Ae,Pa as Br,Q as P,R as Ut,S as Rn,T as De,U as _,V as y,W as q,X as Nn,Y as Vn,Z as ce,_ as br,a as Ve,aa as R,b as cr,ba as Er,c as ur,ca as Sr,da as Cr,e as hr,ea as Tr,f as dr,fa as Ar,g as k,ga as b,h as Rt,ha as Bt,i as fe,ia as ke,j as ft,k as je,ka as xe,l as _e,la as Me,m as Te,ma as Oe,n as Nt,na as qt,o as Y,oa as X,p as pt,q as le,qa as Ke,r as fr,ra as Ti,s as pr,sa as jn,t as mr,ta as Dr,u as Mn,ua as Ai,v as G,va as kr,w as z,wa as Ln,x as On,xa as $n,y as Vt,ya as Ht,z as mt,za as xr}from"./chunk-EC6FYDXY.js";import{a as j,b as ae,c as lr,e as Ce,g as _l,h as vl,i as d}from"./chunk-P2VZOJAX.js";var Rs=Ce(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});var Ps=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Fs.default=Ps});var Vs=Ce(si=>{"use strict";var sa=si&&si.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(si,"__esModule",{value:!0});var eh=sa((Gr(),vl(wl))),th=sa(Rs()),Ns=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=eh.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=Object.assign({},this.headers),this.headers[t]=e,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let i=this.fetch,s=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(r=>d(this,null,function*(){var o,a,l;let c=null,u=null,h=null,p=r.status,f=r.statusText;if(r.ok){if(this.method!=="HEAD"){let x=yield r.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}let g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=r.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,p=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{let g=yield r.text();try{c=JSON.parse(g),Array.isArray(c)&&r.status===404&&(u=[],c=null,p=200,f="OK")}catch{r.status===404&&g===""?(p=204,f="No Content"):c={message:g}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new th.default(c)}return{error:c,data:u,count:h,status:p,statusText:f}}));return this.shouldThrowOnError||(s=s.catch(r=>{var o,a,l;return{error:{message:`${(o=r?.name)!==null&&o!==void 0?o:"FetchError"}: ${r?.message}`,details:`${(a=r?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=r?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}};si.default=Ns});var Ls=Ce(ri=>{"use strict";var ih=ri&&ri.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ri,"__esModule",{value:!0});var nh=ih(Vs()),js=class extends nh.default{select(t){let e=!1,i=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:i,foreignTable:s,referencedTable:r=s}={}){let o=r?`${r}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:i=e}={}){let s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:i,referencedTable:s=i}={}){let r=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:i=!1,buffers:s=!1,wal:r=!1,format:o="text"}={}){var a;let l=[t?"analyze":null,e?"verbose":null,i?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ri.default=js});var sn=Ce(oi=>{"use strict";var sh=oi&&oi.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(oi,"__esModule",{value:!0});var rh=sh(Ls()),$s=class extends rh.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let i=Array.from(new Set(e)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:i,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");let o=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${r}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,i])=>{this.url.searchParams.append(e,`eq.${i}`)}),this}not(t,e,i){return this.url.searchParams.append(t,`not.${e}.${i}`),this}or(t,{foreignTable:e,referencedTable:i=e}={}){let s=i?`${i}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,i){return this.url.searchParams.append(t,`${e}.${i}`),this}};oi.default=$s});var Bs=Ce(li=>{"use strict";var oh=li&&li.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(li,"__esModule",{value:!0});var ai=oh(sn()),Us=class{constructor(t,{headers:e={},schema:i,fetch:s}){this.url=t,this.headers=e,this.schema=i,this.fetch=s}select(t,{head:e=!1,count:i}={}){let s=e?"HEAD":"GET",r=!1,o=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",o),i&&(this.headers.Prefer=`count=${i}`),new ai.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:i=!0}={}){let s="POST",r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),e&&r.push(`count=${e}`),i||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(t)){let o=t.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){let a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new ai.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:i=!1,count:s,defaultToNull:r=!0}={}){let o="POST",a=[`resolution=${i?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){let l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){let c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new ai.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){let i="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),this.headers.Prefer=s.join(","),new ai.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){let e="DELETE",i=[];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new ai.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};li.default=Us});var ra=Ce(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.version=void 0;rn.version="0.0.0-automated"});var oa=Ce(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.DEFAULT_HEADERS=void 0;var ah=ra();on.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ah.version}`}});var la=Ce(ci=>{"use strict";var aa=ci&&ci.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ci,"__esModule",{value:!0});var lh=aa(Bs()),ch=aa(sn()),uh=oa(),qs=class n{constructor(t,{headers:e={},schema:i,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},uh.DEFAULT_HEADERS),e),this.schemaName=i,this.fetch=s}from(t){let e=new URL(`${this.url}/${t}`);return new lh.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new n(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:i=!1,get:s=!1,count:r}={}){let o,a=new URL(`${this.url}/rpc/${t}`),l;i||s?(o=i?"HEAD":"GET",Object.entries(e).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{a.searchParams.append(u,h)})):(o="POST",l=e);let c=Object.assign({},this.headers);return r&&(c.Prefer=`count=${r}`),new ch.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};ci.default=qs});var ma=Ce(K=>{"use strict";var St=K&&K.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(K,"__esModule",{value:!0});K.PostgrestError=K.PostgrestBuilder=K.PostgrestTransformBuilder=K.PostgrestFilterBuilder=K.PostgrestQueryBuilder=K.PostgrestClient=void 0;var ca=St(la());K.PostgrestClient=ca.default;var ua=St(Bs());K.PostgrestQueryBuilder=ua.default;var ha=St(sn());K.PostgrestFilterBuilder=ha.default;var da=St(Ls());K.PostgrestTransformBuilder=da.default;var fa=St(Vs());K.PostgrestBuilder=fa.default;var pa=St(Rs());K.PostgrestError=pa.default;K.default={PostgrestClient:ca.default,PostgrestQueryBuilder:ua.default,PostgrestFilterBuilder:ha.default,PostgrestTransformBuilder:da.default,PostgrestBuilder:fa.default,PostgrestError:pa.default}});var A=function(n){return n[n.State=0]="State",n[n.Transition=1]="Transition",n[n.Sequence=2]="Sequence",n[n.Group=3]="Group",n[n.Animate=4]="Animate",n[n.Keyframes=5]="Keyframes",n[n.Style=6]="Style",n[n.Trigger=7]="Trigger",n[n.Reference=8]="Reference",n[n.AnimateChild=9]="AnimateChild",n[n.AnimateRef=10]="AnimateRef",n[n.Query=11]="Query",n[n.Stagger=12]="Stagger",n}(A||{}),ve="*";function zr(n,t){return{type:A.Trigger,name:n,definitions:t,options:{}}}function Un(n,t=null){return{type:A.Animate,styles:t,timings:n}}function Kr(n,t=null){return{type:A.Sequence,steps:n,options:t}}function Je(n){return{type:A.Style,styles:n,offset:null}}function ki(n,t,e){return{type:A.State,name:n,styles:t,options:e}}function Bn(n,t,e=null){return{type:A.Transition,expr:n,animation:t,options:e}}var $e=class{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){let e=t=="start"?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}},Gt=class{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,s=0,r=this.players.length;r==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==r&&this._onFinish()}),o.onDestroy(()=>{++i==r&&this._onDestroy()}),o.onStart(()=>{++s==r&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){let e=t*this.totalTime;this.players.forEach(i=>{let s=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(s)})}getPosition(){let t=this.players.reduce((e,i)=>e===null||i.totalTime>e.totalTime?i:e,null);return t!=null?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){let e=t=="start"?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}},xi="!";var Wr=["toast-component",""];function bl(n,t){if(n&1){let e=ce();_(0,"button",5),$("click",function(){G(e);let s=R();return z(s.remove())}),_(1,"span",6),b(2,"\xD7"),y()()}}function El(n,t){if(n&1&&(Nn(0),b(1),Vn()),n&2){let e=R(2);C(),ke("[",e.duplicatesCount+1,"]")}}function Sl(n,t){if(n&1&&(_(0,"div"),b(1),Z(2,El,2,1,"ng-container",4),y()),n&2){let e=R();De(e.options.titleClass),Ae("aria-label",e.title),C(),ke(" ",e.title," "),C(),P("ngIf",e.duplicatesCount)}}function Cl(n,t){if(n&1&&q(0,"div",7),n&2){let e=R();De(e.options.messageClass),P("innerHTML",e.message,Pn)}}function Tl(n,t){if(n&1&&(_(0,"div",8),b(1),y()),n&2){let e=R();De(e.options.messageClass),Ae("aria-label",e.message),C(),ke(" ",e.message," ")}}function Al(n,t){if(n&1&&(_(0,"div"),q(1,"div",9),y()),n&2){let e=R();C(),Ut("width",e.width()+"%")}}function Dl(n,t){if(n&1){let e=ce();_(0,"button",5),$("click",function(){G(e);let s=R();return z(s.remove())}),_(1,"span",6),b(2,"\xD7"),y()()}}function kl(n,t){if(n&1&&(Nn(0),b(1),Vn()),n&2){let e=R(2);C(),ke("[",e.duplicatesCount+1,"]")}}function xl(n,t){if(n&1&&(_(0,"div"),b(1),Z(2,kl,2,1,"ng-container",4),y()),n&2){let e=R();De(e.options.titleClass),Ae("aria-label",e.title),C(),ke(" ",e.title," "),C(),P("ngIf",e.duplicatesCount)}}function Ml(n,t){if(n&1&&q(0,"div",7),n&2){let e=R();De(e.options.messageClass),P("innerHTML",e.message,Pn)}}function Ol(n,t){if(n&1&&(_(0,"div",8),b(1),y()),n&2){let e=R();De(e.options.messageClass),Ae("aria-label",e.message),C(),ke(" ",e.message," ")}}function Il(n,t){if(n&1&&(_(0,"div"),q(1,"div",9),y()),n&2){let e=R();C(),Ut("width",e.width()+"%")}}var qn=class{_attachedHost;component;viewContainerRef;injector;constructor(t,e){this.component=t,this.injector=e}attach(t,e){return this._attachedHost=t,t.attach(this,e)}detach(){let t=this._attachedHost;if(t)return this._attachedHost=void 0,t.detach()}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},Hn=class{_attachedPortal;_disposeFn;attach(t,e){return this._attachedPortal=t,this.attachComponentPortal(t,e)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(t){this._disposeFn=t}},Gn=class{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new Ve;_activate=new Ve;_manualClose=new Ve;_resetTimeout=new Ve;_countDuplicate=new Ve;constructor(t){this._overlayRef=t}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(t,e){t&&this._resetTimeout.next(),e&&this._countDuplicate.next(++this.duplicatesCount)}},gt=class{toastId;config;message;title;toastType;toastRef;_onTap=new Ve;_onAction=new Ve;constructor(t,e,i,s,r,o){this.toastId=t,this.config=e,this.message=i,this.title=s,this.toastType=r,this.toastRef=o,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(t){this._onAction.next(t)}onAction(){return this._onAction.asObservable()}},Jr={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing"},Qr=new je("ToastConfig"),zn=class extends Hn{_hostDomElement;_componentFactoryResolver;_appRef;constructor(t,e,i){super(),this._hostDomElement=t,this._componentFactoryResolver=e,this._appRef=i}attachComponentPortal(t,e){let i=this._componentFactoryResolver.resolveComponentFactory(t.component),s;return s=i.create(t.injector),this._appRef.attachView(s.hostView),this.setDisposeFn(()=>{this._appRef.detachView(s.hostView),s.destroy()}),e?this._hostDomElement.insertBefore(this._getComponentRootNode(s),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(s)),s}_getComponentRootNode(t){return t.hostView.rootNodes[0]}},Pl=(()=>{class n{_document=Te(Ht);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let e=this._document.createElement("div");e.classList.add("overlay-container"),e.setAttribute("aria-live","polite"),this._document.body.appendChild(e),this._containerElement=e}static \u0275fac=function(i){return new(i||n)};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Kn=class{_portalHost;constructor(t){this._portalHost=t}attach(t,e=!0){return this._portalHost.attach(t,e)}detach(){return this._portalHost.detach()}},Fl=(()=>{class n{_overlayContainer=Te(Pl);_componentFactoryResolver=Te(vr);_appRef=Te(Ai);_document=Te(Ht);_paneElements=new Map;create(e,i){return this._createOverlayRef(this.getPaneElement(e,i))}getPaneElement(e="",i){return this._paneElements.get(i)||this._paneElements.set(i,{}),this._paneElements.get(i)[e]||(this._paneElements.get(i)[e]=this._createPaneElement(e,i)),this._paneElements.get(i)[e]}_createPaneElement(e,i){let s=this._document.createElement("div");return s.id="toast-container",s.classList.add(e),s.classList.add("toast-container"),i?i.getContainerElement().appendChild(s):this._overlayContainer.getContainerElement().appendChild(s),s}_createPortalHost(e){return new zn(e,this._componentFactoryResolver,this._appRef)}_createOverlayRef(e){return new Kn(this._createPortalHost(e))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Mi=(()=>{class n{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(e,i,s,r,o){this.overlay=i,this._injector=s,this.sanitizer=r,this.ngZone=o,this.toastrConfig=j(j({},e.default),e.config),e.config.iconClasses&&(this.toastrConfig.iconClasses=j(j({},e.default.iconClasses),e.config.iconClasses))}show(e,i,s={},r=""){return this._preBuildNotification(r,e,i,this.applyConfig(s))}success(e,i,s={}){let r=this.toastrConfig.iconClasses.success||"";return this._preBuildNotification(r,e,i,this.applyConfig(s))}error(e,i,s={}){let r=this.toastrConfig.iconClasses.error||"";return this._preBuildNotification(r,e,i,this.applyConfig(s))}info(e,i,s={}){let r=this.toastrConfig.iconClasses.info||"";return this._preBuildNotification(r,e,i,this.applyConfig(s))}warning(e,i,s={}){let r=this.toastrConfig.iconClasses.warning||"";return this._preBuildNotification(r,e,i,this.applyConfig(s))}clear(e){for(let i of this.toasts)if(e!==void 0){if(i.toastId===e){i.toastRef.manualClose();return}}else i.toastRef.manualClose()}remove(e){let i=this._findToast(e);if(!i||(i.activeToast.toastRef.close(),this.toasts.splice(i.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){let s=this.toasts[this.currentlyActive].toastRef;s.isInactive()||(this.currentlyActive=this.currentlyActive+1,s.activate())}return!0}findDuplicate(e="",i="",s,r){let{includeTitleDuplicates:o}=this.toastrConfig;for(let a of this.toasts){let l=o&&a.title===e;if((!o||l)&&a.message===i)return a.toastRef.onDuplicate(s,r),a}return null}applyConfig(e={}){return j(j({},this.toastrConfig),e)}_findToast(e){for(let i=0;i<this.toasts.length;i++)if(this.toasts[i].toastId===e)return{index:i,activeToast:this.toasts[i]};return null}_preBuildNotification(e,i,s,r){return r.onActivateTick?this.ngZone.run(()=>this._buildNotification(e,i,s,r)):this._buildNotification(e,i,s,r)}_buildNotification(e,i,s,r){if(!r.toastComponent)throw new Error("toastComponent required");let o=this.findDuplicate(s,i,this.toastrConfig.resetTimeoutOnDuplicate&&r.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&s||i)&&this.toastrConfig.preventDuplicates&&o!==null)return o;this.previousToastMessage=i;let a=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(a=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));let l=this.overlay.create(r.positionClass,this.overlayContainer);this.index=this.index+1;let c=i;i&&r.enableHtml&&(c=this.sanitizer.sanitize(gr.HTML,i));let u=new Gn(l),h=new gt(this.index,r,c,s,e,u),p=[{provide:gt,useValue:h}],f=Vt.create({providers:p,parent:this._injector}),m=new qn(r.toastComponent,f),g=l.attach(m,r.newestOnTop);u.componentInstance=g.instance;let v={toastId:this.index,title:s||"",message:i||"",toastRef:u,onShown:u.afterActivate(),onHidden:u.afterClosed(),onTap:h.onTap(),onAction:h.onAction(),portal:g};return a||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{v.toastRef.activate()})),this.toasts.push(v),v}static \u0275fac=function(i){return new(i||n)(_e(Qr),_e(Fl),_e(Vt),_e(jr),_e(Lt))};static \u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Rl=(()=>{class n{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=$t(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if(this.state().value==="inactive")return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(e,i,s){this.toastrService=e,this.toastPackage=i,this.ngZone=s,this.message=i.message,this.title=i.title,this.options=i.config,this.originalTimeout=i.config.timeOut,this.toastClasses=`${i.toastType} ${i.config.toastClass}`,this.sub=i.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=i.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=i.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=i.toastRef.countDuplicate().subscribe(r=>{this.duplicatesCount=r}),this.state=$t({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(e=>ae(j({},e),{value:"active"})),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let e=new Date().getTime(),i=this.hideTime-e;this.width.set(i/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(s=>100-s),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(e=>ae(j({},e),{value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){this.state().value!=="removed"&&(clearTimeout(this.timeout),this.state.update(e=>ae(j({},e),{value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){this.state().value!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state().value!=="removed"&&this.options.disableTimeOut!=="extendedTimeOut"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state().value==="removed"||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(e,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(e),i)):this.timeout=setTimeout(()=>e(),i)}outsideInterval(e,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(e),i)):this.intervalId=setInterval(()=>e(),i)}runInsideAngular(e){this.ngZone?this.ngZone.run(()=>e()):e()}static \u0275fac=function(i){return new(i||n)(O(Mi),O(gt),O(Lt))};static \u0275cmp=Y({type:n,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(i,s){i&1&&$("click",function(){return s.tapToast()})("mouseenter",function(){return s.stickAround()})("mouseleave",function(){return s.delayedHideToast()}),i&2&&(br("@flyInOut",s._state),De(s.toastClasses),Ut("display",s.displayStyle))},standalone:!0,features:[X],attrs:Wr,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,s){i&1&&Z(0,bl,3,0,"button",0)(1,Sl,3,5,"div",1)(2,Cl,1,3,"div",2)(3,Tl,2,4,"div",3)(4,Al,2,2,"div",4),i&2&&(P("ngIf",s.options.closeButton),C(),P("ngIf",s.title),C(),P("ngIf",s.message&&s.options.enableHtml),C(),P("ngIf",s.message&&!s.options.enableHtml),C(),P("ngIf",s.options.progressBar))},dependencies:[We],encapsulation:2,data:{animation:[zr("flyInOut",[ki("inactive",Je({opacity:0})),ki("active",Je({opacity:1})),ki("removed",Je({opacity:0})),Bn("inactive => active",Un("{{ easeTime }}ms {{ easing }}")),Bn("active => removed",Un("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return n})(),Nl=ae(j({},Jr),{toastComponent:Rl}),Yr=(n={})=>pr([{provide:Qr,useValue:{default:Nl,config:n}}]);var Vl=(()=>{class n{toastrService;toastPackage;appRef;message;title;options;duplicatesCount;originalTimeout;width=$t(-1);toastClasses="";get displayStyle(){return this.state()==="inactive"?"none":null}state=$t("inactive");timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(e,i,s){this.toastrService=e,this.toastPackage=i,this.appRef=s,this.message=i.message,this.title=i.title,this.options=i.config,this.originalTimeout=i.config.timeOut,this.toastClasses=`${i.toastType} ${i.config.toastClass}`,this.sub=i.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=i.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=i.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=i.toastRef.countDuplicate().subscribe(r=>{this.duplicatesCount=r})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.set("active"),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let e=new Date().getTime(),i=this.hideTime-e;this.width.set(i/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(s=>100-s),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.set("active"),this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=new Date().getTime()+(this.originalTimeout||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.state.set("removed"),this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){this.state()!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state()==="removed"||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}static \u0275fac=function(i){return new(i||n)(O(Mi),O(gt),O(Ai))};static \u0275cmp=Y({type:n,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(i,s){i&1&&$("click",function(){return s.tapToast()})("mouseenter",function(){return s.stickAround()})("mouseleave",function(){return s.delayedHideToast()}),i&2&&(De(s.toastClasses),Ut("display",s.displayStyle))},standalone:!0,features:[X],attrs:Wr,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,s){i&1&&Z(0,Dl,3,0,"button",0)(1,xl,3,5,"div",1)(2,Ml,1,3,"div",2)(3,Ol,2,4,"div",3)(4,Il,2,2,"div",4),i&2&&(P("ngIf",s.options.closeButton),C(),P("ngIf",s.title),C(),P("ngIf",s.message&&s.options.enableHtml),C(),P("ngIf",s.message&&!s.options.enableHtml),C(),P("ngIf",s.options.progressBar))},dependencies:[We],encapsulation:2,changeDetection:0})}return n})(),dd=ae(j({},Jr),{toastComponent:Vl});function Zr(n){return new k(3e3,!1)}function Ll(){return new k(3100,!1)}function $l(){return new k(3101,!1)}function Ul(n){return new k(3001,!1)}function Bl(n){return new k(3003,!1)}function ql(n){return new k(3004,!1)}function Hl(n,t){return new k(3005,!1)}function Gl(){return new k(3006,!1)}function zl(){return new k(3007,!1)}function Kl(n,t){return new k(3008,!1)}function Wl(n){return new k(3002,!1)}function Jl(n,t,e,i,s){return new k(3010,!1)}function Ql(){return new k(3011,!1)}function Yl(){return new k(3012,!1)}function Zl(){return new k(3200,!1)}function Xl(){return new k(3202,!1)}function ec(){return new k(3013,!1)}function tc(n){return new k(3014,!1)}function ic(n){return new k(3015,!1)}function nc(n){return new k(3016,!1)}function sc(n,t){return new k(3404,!1)}function rc(n){return new k(3502,!1)}function oc(n){return new k(3503,!1)}function ac(){return new k(3300,!1)}function lc(n){return new k(3504,!1)}function cc(n){return new k(3301,!1)}function uc(n,t){return new k(3302,!1)}function hc(n){return new k(3303,!1)}function dc(n,t){return new k(3400,!1)}function fc(n){return new k(3401,!1)}function pc(n){return new k(3402,!1)}function mc(n,t){return new k(3505,!1)}function Ue(n){switch(n.length){case 0:return new $e;case 1:return n[0];default:return new Gt(n)}}function fo(n,t,e=new Map,i=new Map){let s=[],r=[],o=-1,a=null;if(t.forEach(l=>{let c=l.get("offset"),u=c==o,h=u&&a||new Map;l.forEach((p,f)=>{let m=f,g=p;if(f!=="offset")switch(m=n.normalizePropertyName(m,s),g){case xi:g=e.get(f);break;case ve:g=i.get(f);break;default:g=n.normalizeStyleValue(f,m,g,s);break}h.set(m,g)}),u||r.push(h),a=h,o=c}),s.length)throw rc(s);return r}function gs(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&Wn(e,"start",n)));break;case"done":n.onDone(()=>i(e&&Wn(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&Wn(e,"destroy",n)));break}}function Wn(n,t,e){let i=e.totalTime,s=!!e.disabled,r=ys(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,i??n.totalTime,s),o=n._data;return o!=null&&(r._data=o),r}function ys(n,t,e,i,s="",r=0,o){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:s,totalTime:r,disabled:!!o}}function se(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function Xr(n){let t=n.indexOf(":"),e=n.substring(1,t),i=n.slice(t+1);return[e,i]}var gc=typeof document>"u"?null:document.documentElement;function _s(n){let t=n.parentNode||n.host||null;return t===gc?null:t}function yc(n){return n.substring(1,6)=="ebkit"}var Qe=null,eo=!1;function _c(n){Qe||(Qe=vc()||{},eo=Qe.style?"WebkitAppearance"in Qe.style:!1);let t=!0;return Qe.style&&!yc(n)&&(t=n in Qe.style,!t&&eo&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Qe.style)),t}function vc(){return typeof document<"u"?document.body:null}function po(n,t){for(;t;){if(t===n)return!0;t=_s(t)}return!1}function mo(n,t,e){if(e)return Array.from(n.querySelectorAll(t));let i=n.querySelector(t);return i?[i]:[]}var vs=(()=>{class n{validateStyleProperty(e){return _c(e)}matchesElement(e,i){return!1}containsElement(e,i){return po(e,i)}getParentElement(e){return _s(e)}query(e,i,s){return mo(e,i,s)}computeStyle(e,i,s){return s||""}animate(e,i,s,r,o,a=[],l){return new $e(s,r)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=fe({token:n,factory:n.\u0275fac})}}return n})(),Xe=class{static{this.NOOP=new vs}},et=class{};var wc=1e3,go="{{",bc="}}",yo="ng-enter",es="ng-leave",Oi="ng-trigger",Ni=".ng-trigger",to="ng-animating",ts=".ng-animating";function Ie(n){if(typeof n=="number")return n;let t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:is(parseFloat(t[1]),t[2])}function is(n,t){switch(t){case"s":return n*wc;default:return n}}function Vi(n,t,e){return n.hasOwnProperty("duration")?n:Ec(n,t,e)}function Ec(n,t,e){let i=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,s,r=0,o="";if(typeof n=="string"){let a=n.match(i);if(a===null)return t.push(Zr(n)),{duration:0,delay:0,easing:""};s=is(parseFloat(a[1]),a[2]);let l=a[3];l!=null&&(r=is(parseFloat(l),a[4]));let c=a[5];c&&(o=c)}else s=n;if(!e){let a=!1,l=t.length;s<0&&(t.push(Ll()),a=!0),r<0&&(t.push($l()),a=!0),a&&t.splice(l,0,Zr(n))}return{duration:s,delay:r,easing:o}}function Sc(n){return n.length?n[0]instanceof Map?n:n.map(t=>new Map(Object.entries(t))):[]}function we(n,t,e){t.forEach((i,s)=>{let r=ws(s);e&&!e.has(s)&&e.set(s,n.style[r]),n.style[r]=i})}function Ze(n,t){t.forEach((e,i)=>{let s=ws(i);n.style[s]=""})}function zt(n){return Array.isArray(n)?n.length==1?n[0]:Kr(n):n}function Cc(n,t,e){let i=t.params||{},s=_o(n);s.length&&s.forEach(r=>{i.hasOwnProperty(r)||e.push(Ul(r))})}var ns=new RegExp(`${go}\\s*(.+?)\\s*${bc}`,"g");function _o(n){let t=[];if(typeof n=="string"){let e;for(;e=ns.exec(n);)t.push(e[1]);ns.lastIndex=0}return t}function Wt(n,t,e){let i=`${n}`,s=i.replace(ns,(r,o)=>{let a=t[o];return a==null&&(e.push(Bl(o)),a=""),a.toString()});return s==i?n:s}var Tc=/-+([a-z0-9])/g;function ws(n){return n.replace(Tc,(...t)=>t[1].toUpperCase())}function Ac(n,t){return n===0||t===0}function Dc(n,t,e){if(e.size&&t.length){let i=t[0],s=[];if(e.forEach((r,o)=>{i.has(o)||s.push(o),i.set(o,r)}),s.length)for(let r=1;r<t.length;r++){let o=t[r];s.forEach(a=>o.set(a,bs(n,a)))}}return t}function ne(n,t,e){switch(t.type){case A.Trigger:return n.visitTrigger(t,e);case A.State:return n.visitState(t,e);case A.Transition:return n.visitTransition(t,e);case A.Sequence:return n.visitSequence(t,e);case A.Group:return n.visitGroup(t,e);case A.Animate:return n.visitAnimate(t,e);case A.Keyframes:return n.visitKeyframes(t,e);case A.Style:return n.visitStyle(t,e);case A.Reference:return n.visitReference(t,e);case A.AnimateChild:return n.visitAnimateChild(t,e);case A.AnimateRef:return n.visitAnimateRef(t,e);case A.Query:return n.visitQuery(t,e);case A.Stagger:return n.visitStagger(t,e);default:throw ql(t.type)}}function bs(n,t){return window.getComputedStyle(n)[t]}var kc=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),ji=class extends et{normalizePropertyName(t,e){return ws(t)}normalizeStyleValue(t,e,i,s){let r="",o=i.toString().trim();if(kc.has(e)&&i!==0&&i!=="0")if(typeof i=="number")r="px";else{let a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&s.push(Hl(t,i))}return o+r}};var Li="*";function xc(n,t){let e=[];return typeof n=="string"?n.split(/\s*,\s*/).forEach(i=>Mc(i,e,t)):e.push(n),e}function Mc(n,t,e){if(n[0]==":"){let l=Oc(n,e);if(typeof l=="function"){t.push(l);return}n=l}let i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(i==null||i.length<4)return e.push(ic(n)),t;let s=i[1],r=i[2],o=i[3];t.push(io(s,o));let a=s==Li&&o==Li;r[0]=="<"&&!a&&t.push(io(o,s))}function Oc(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(nc(n)),"* => *"}}var Ii=new Set(["true","1"]),Pi=new Set(["false","0"]);function io(n,t){let e=Ii.has(n)||Pi.has(n),i=Ii.has(t)||Pi.has(t);return(s,r)=>{let o=n==Li||n==s,a=t==Li||t==r;return!o&&e&&typeof s=="boolean"&&(o=s?Ii.has(n):Pi.has(n)),!a&&i&&typeof r=="boolean"&&(a=r?Ii.has(t):Pi.has(t)),o&&a}}var vo=":self",Ic=new RegExp(`s*${vo}s*,?`,"g");function wo(n,t,e,i){return new ss(n).build(t,e,i)}var no="",ss=class{constructor(t){this._driver=t}build(t,e,i){let s=new rs(e);return this._resetContextStyleTimingState(s),ne(this,zt(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector=no,t.collectedStyles=new Map,t.collectedStyles.set(no,new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,s=e.depCount=0,r=[],o=[];return t.name.charAt(0)=="@"&&e.errors.push(Gl()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==A.State){let l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,r.push(this.visitState(l,e))}),l.name=c}else if(a.type==A.Transition){let l=this.visitTransition(a,e);i+=l.queryCount,s+=l.depCount,o.push(l)}else e.errors.push(zl())}),{type:A.Trigger,name:t.name,states:r,transitions:o,queryCount:i,depCount:s,options:null}}visitState(t,e){let i=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(i.containsDynamicStyles){let r=new Set,o=s||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{_o(l).forEach(c=>{o.hasOwnProperty(c)||r.add(c)})})}),r.size&&e.errors.push(Kl(t.name,[...r.values()]))}return{type:A.State,name:t.name,style:i,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;let i=ne(this,zt(t.animation),e),s=xc(t.expr,e.errors);return{type:A.Transition,matchers:s,animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Ye(t.options)}}visitSequence(t,e){return{type:A.Sequence,steps:t.steps.map(i=>ne(this,i,e)),options:Ye(t.options)}}visitGroup(t,e){let i=e.currentTime,s=0,r=t.steps.map(o=>{e.currentTime=i;let a=ne(this,o,e);return s=Math.max(s,e.currentTime),a});return e.currentTime=s,{type:A.Group,steps:r,options:Ye(t.options)}}visitAnimate(t,e){let i=Nc(t.timings,e.errors);e.currentAnimateTimings=i;let s,r=t.styles?t.styles:Je({});if(r.type==A.Keyframes)s=this.visitKeyframes(r,e);else{let o=t.styles,a=!1;if(!o){a=!0;let c={};i.easing&&(c.easing=i.easing),o=Je(c)}e.currentTime+=i.duration+i.delay;let l=this.visitStyle(o,e);l.isEmptyStep=a,s=l}return e.currentAnimateTimings=null,{type:A.Animate,timings:i,style:s,options:null}}visitStyle(t,e){let i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){let i=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let a of s)typeof a=="string"?a===ve?i.push(a):e.errors.push(Wl(a)):i.push(new Map(Object.entries(a)));let r=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!r)){for(let l of a.values())if(l.toString().indexOf(go)>=0){r=!0;break}}}),{type:A.Style,styles:i,easing:o,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){let i=e.currentAnimateTimings,s=e.currentTime,r=e.currentTime;i&&r>0&&(r-=i.duration+i.delay),t.styles.forEach(o=>{typeof o!="string"&&o.forEach((a,l)=>{let c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l),h=!0;u&&(r!=s&&r>=u.startTime&&s<=u.endTime&&(e.errors.push(Jl(l,u.startTime,u.endTime,r,s)),h=!1),r=u.startTime),h&&c.set(l,{startTime:r,endTime:s}),e.options&&Cc(a,e.options,e.errors)})})}visitKeyframes(t,e){let i={type:A.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(Ql()),i;let s=1,r=0,o=[],a=!1,l=!1,c=0,u=t.steps.map(x=>{let F=this._makeStyleAst(x,e),N=F.offset!=null?F.offset:Rc(F.styles),I=0;return N!=null&&(r++,I=F.offset=N),l=l||I<0||I>1,a=a||I<c,c=I,o.push(I),F});l&&e.errors.push(Yl()),a&&e.errors.push(Zl());let h=t.steps.length,p=0;r>0&&r<h?e.errors.push(Xl()):r==0&&(p=s/(h-1));let f=h-1,m=e.currentTime,g=e.currentAnimateTimings,v=g.duration;return u.forEach((x,F)=>{let N=p>0?F==f?1:p*F:o[F],I=N*v;e.currentTime=m+g.delay+I,g.duration=I,this._validateStyleAst(x,e),x.offset=N,i.styles.push(x)}),i}visitReference(t,e){return{type:A.Reference,animation:ne(this,zt(t.animation),e),options:Ye(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:A.AnimateChild,options:Ye(t.options)}}visitAnimateRef(t,e){return{type:A.AnimateRef,animation:this.visitReference(t.animation,e),options:Ye(t.options)}}visitQuery(t,e){let i=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;let[r,o]=Pc(t.selector);e.currentQuerySelector=i.length?i+" "+r:r,se(e.collectedStyles,e.currentQuerySelector,new Map);let a=ne(this,zt(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:A.Query,selector:r,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:Ye(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(ec());let i=t.timings==="full"?{duration:0,delay:0,easing:"full"}:Vi(t.timings,e.errors,!0);return{type:A.Stagger,animation:ne(this,zt(t.animation),e),timings:i,options:null}}};function Pc(n){let t=!!n.split(/\s*,\s*/).find(e=>e==vo);return t&&(n=n.replace(Ic,"")),n=n.replace(/@\*/g,Ni).replace(/@\w+/g,e=>Ni+"-"+e.slice(1)).replace(/:animating/g,ts),[n,t]}function Fc(n){return n?j({},n):null}var rs=class{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function Rc(n){if(typeof n=="string")return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){let i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){let e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}function Nc(n,t){if(n.hasOwnProperty("duration"))return n;if(typeof n=="number"){let r=Vi(n,t).duration;return Jn(r,0,"")}let e=n;if(e.split(/\s+/).some(r=>r.charAt(0)=="{"&&r.charAt(1)=="{")){let r=Jn(0,0,"");return r.dynamic=!0,r.strValue=e,r}let s=Vi(e,t);return Jn(s.duration,s.delay,s.easing)}function Ye(n){return n?(n=j({},n),n.params&&(n.params=Fc(n.params))):n={},n}function Jn(n,t,e){return{duration:n,delay:t,easing:e}}function Es(n,t,e,i,s,r,o=null,a=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:s,delay:r,totalTime:s+r,easing:o,subTimeline:a}}var Jt=class{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}},Vc=1,jc=":enter",Lc=new RegExp(jc,"g"),$c=":leave",Uc=new RegExp($c,"g");function bo(n,t,e,i,s,r=new Map,o=new Map,a,l,c=[]){return new os().buildKeyframes(n,t,e,i,s,r,o,a,l,c)}var os=class{buildKeyframes(t,e,i,s,r,o,a,l,c,u=[]){c=c||new Jt;let h=new as(t,e,c,s,r,u,[]);h.options=l;let p=l.delay?Ie(l.delay):0;h.currentTimeline.delayNextStep(p),h.currentTimeline.setStyles([o],null,h.errors,l),ne(this,i,h);let f=h.timelines.filter(m=>m.containsAnimation());if(f.length&&a.size){let m;for(let g=f.length-1;g>=0;g--){let v=f[g];if(v.element===e){m=v;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([a],null,h.errors,l)}return f.length?f.map(m=>m.buildKeyframes()):[Es(e,[],[],[],0,p,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){let i=e.subInstructions.get(e.element);if(i){let s=e.createSubContext(t.options),r=e.currentTimeline.currentTime,o=this._visitSubInstructions(i,s,s.options);r!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){let i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,i),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,i){for(let s of t){let r=s?.delay;if(r){let o=typeof r=="number"?r:Ie(Wt(r,s?.params??{},e.errors));i.delayNextStep(o)}}}_visitSubInstructions(t,e,i){let r=e.currentTimeline.currentTime,o=i.duration!=null?Ie(i.duration):null,a=i.delay!=null?Ie(i.delay):null;return o!==0&&t.forEach(l=>{let c=e.appendInstructionToTimeline(l,o,a);r=Math.max(r,c.duration+c.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),ne(this,t.animation,e),e.previousNode=t}visitSequence(t,e){let i=e.subContextCount,s=e,r=t.options;if(r&&(r.params||r.delay)&&(s=e.createSubContext(r),s.transformIntoNewTimeline(),r.delay!=null)){s.previousNode.type==A.Style&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=$i);let o=Ie(r.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>ne(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>i&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){let i=[],s=e.currentTimeline.currentTime,r=t.options&&t.options.delay?Ie(t.options.delay):0;t.steps.forEach(o=>{let a=e.createSubContext(t.options);r&&a.delayNextStep(r),ne(this,o,a),s=Math.max(s,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){let i=t.strValue,s=e.params?Wt(i,e.params,e.errors):i;return Vi(s,e.errors)}else return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){let i=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),s.snapshotCurrentStyles());let r=t.style;r.type==A.Keyframes?this.visitKeyframes(r,e):(e.incrementTime(i.duration),this.visitStyle(r,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){let i=e.currentTimeline,s=e.currentAnimateTimings;!s&&i.hasCurrentStyleProperties()&&i.forwardFrame();let r=s&&s.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(r):i.setStyles(t.styles,r,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){let i=e.currentAnimateTimings,s=e.currentTimeline.duration,r=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(l=>{let c=l.offset||0;a.forwardTime(c*r),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(s+r),e.previousNode=t}visitQuery(t,e){let i=e.currentTimeline.currentTime,s=t.options||{},r=s.delay?Ie(s.delay):0;r&&(e.previousNode.type===A.Style||i==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=$i);let o=i,a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;let h=e.createSubContext(t.options,c);r&&h.delayNextStep(r),c===e.element&&(l=h.currentTimeline),ne(this,t.animation,h),h.currentTimeline.applyStylesToKeyframe();let p=h.currentTimeline.currentTime;o=Math.max(o,p)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){let i=e.parentContext,s=e.currentTimeline,r=t.timings,o=Math.abs(r.duration),a=o*(e.currentQueryTotal-1),l=o*e.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime;break}let u=e.currentTimeline;l&&u.delayNextStep(l);let h=u.currentTime;ne(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=s.currentTime-h+(s.startTime-i.currentTimeline.startTime)}},$i={},as=class n{constructor(t,e,i,s,r,o,a,l){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=s,this._leaveClassName=r,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=$i,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Ui(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;let i=t,s=this.options;i.duration!=null&&(s.duration=Ie(i.duration)),i.delay!=null&&(s.delay=Ie(i.delay));let r=i.params;if(r){let o=s.params;o||(o=this.options.params={}),Object.keys(r).forEach(a=>{(!e||!o.hasOwnProperty(a))&&(o[a]=Wt(r[a],o,this.errors))})}}_copyOptions(){let t={};if(this.options){let e=this.options.params;if(e){let i=t.params={};Object.keys(e).forEach(s=>{i[s]=e[s]})}}return t}createSubContext(t=null,e,i){let s=e||this.element,r=new n(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,i||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(t),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(t){return this.previousNode=$i,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){let s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},r=new ls(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(r),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,s,r,o){let a=[];if(s&&a.push(this.element),t.length>0){t=t.replace(Lc,"."+this._enterClassName),t=t.replace(Uc,"."+this._leaveClassName);let l=i!=1,c=this._driver.query(this.element,t,l);i!==0&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!r&&a.length==0&&o.push(tc(e)),a}},Ui=class n{constructor(t,e,i,s){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=s,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new n(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=Vc,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||ve),this._currentKeyframe.set(e,ve);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,s){e&&this._previousKeyframe.set("easing",e);let r=s&&s.params||{},o=Bc(t,this._globalTimelineStyles);for(let[a,l]of o){let c=Wt(l,r,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ve),this._updateStyle(a,c)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{let s=this._styleSummary.get(i);(!s||e.time>s.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let t=new Set,e=new Set,i=this._keyframes.size===1&&this.duration===0,s=[];this._keyframes.forEach((a,l)=>{let c=new Map([...this._backFill,...a]);c.forEach((u,h)=>{u===xi?t.add(h):u===ve&&e.add(h)}),i||c.set("offset",l/this.duration),s.push(c)});let r=[...t.values()],o=[...e.values()];if(i){let a=s[0],l=new Map(a);a.set("offset",0),l.set("offset",1),s=[a,l]}return Es(this.element,s,r,o,this.duration,this.startTime,this.easing,!1)}},ls=class extends Ui{constructor(t,e,i,s,r,o,a=!1){super(t,e,o.delay),this.keyframes=i,this.preStyleProps=s,this.postStyleProps=r,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){let r=[],o=i+e,a=e/o,l=new Map(t[0]);l.set("offset",0),r.push(l);let c=new Map(t[0]);c.set("offset",so(a)),r.push(c);let u=t.length-1;for(let h=1;h<=u;h++){let p=new Map(t[h]),f=p.get("offset"),m=e+f*i;p.set("offset",so(m/o)),r.push(p)}i=o,e=0,s="",t=r}return Es(this.element,t,this.preStyleProps,this.postStyleProps,i,e,s,!0)}};function so(n,t=3){let e=Math.pow(10,t-1);return Math.round(n*e)/e}function Bc(n,t){let e=new Map,i;return n.forEach(s=>{if(s==="*"){i??=t.keys();for(let r of i)e.set(r,ve)}else for(let[r,o]of s)e.set(r,o)}),e}function ro(n,t,e,i,s,r,o,a,l,c,u,h,p){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:r,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:p}}var Qn={},Bi=class{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,s){return qc(this.ast.matchers,t,e,i,s)}buildStyles(t,e,i){let s=this._stateStyles.get("*");return t!==void 0&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,i):new Map}build(t,e,i,s,r,o,a,l,c,u){let h=[],p=this.ast.options&&this.ast.options.params||Qn,f=a&&a.params||Qn,m=this.buildStyles(i,f,h),g=l&&l.params||Qn,v=this.buildStyles(s,g,h),x=new Set,F=new Map,N=new Map,I=s==="void",W={params:Eo(g,p),delay:this.ast.options?.delay},H=u?[]:bo(t,e,this.ast.animation,r,o,m,v,W,c,h),Q=0;return H.forEach(ee=>{Q=Math.max(ee.duration+ee.delay,Q)}),h.length?ro(e,this._triggerName,i,s,I,m,v,[],[],F,N,Q,h):(H.forEach(ee=>{let He=ee.element,dt=se(F,He,new Set);ee.preStyleProps.forEach(Ge=>dt.add(Ge));let sr=se(N,He,new Set);ee.postStyleProps.forEach(Ge=>sr.add(Ge)),He!==e&&x.add(He)}),ro(e,this._triggerName,i,s,I,m,v,H,[...x.values()],F,N,Q))}};function qc(n,t,e,i,s){return n.some(r=>r(t,e,i,s))}function Eo(n,t){let e=j({},t);return Object.entries(n).forEach(([i,s])=>{s!=null&&(e[i]=s)}),e}var cs=class{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){let i=new Map,s=Eo(t,this.defaultParams);return this.styles.styles.forEach(r=>{typeof r!="string"&&r.forEach((o,a)=>{o&&(o=Wt(o,s,e));let l=this.normalizer.normalizePropertyName(a,e);o=this.normalizer.normalizeStyleValue(a,l,o,e),i.set(a,o)})}),i}};function Hc(n,t,e){return new us(n,t,e)}var us=class{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{let r=s.options&&s.options.params||{};this.states.set(s.name,new cs(s.style,r,i))}),oo(this.states,"true","1"),oo(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new Bi(t,s,this.states))}),this.fallbackTransition=Gc(t,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,s){return this.transitionFactories.find(o=>o.match(t,e,i,s))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}};function Gc(n,t,e){let i=[(o,a)=>!0],s={type:A.Sequence,steps:[],options:null},r={type:A.Transition,animation:s,matchers:i,options:null,queryCount:0,depCount:0};return new Bi(n,r,t)}function oo(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}var zc=new Jt,hs=class{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){let i=[],s=[],r=wo(this._driver,e,i,s);if(i.length)throw oc(i);s.length&&void 0,this._animations.set(t,r)}_buildPlayer(t,e,i){let s=t.element,r=fo(this._normalizer,t.keyframes,e,i);return this._driver.animate(s,r,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){let s=[],r=this._animations.get(t),o,a=new Map;if(r?(o=bo(this._driver,e,r,yo,es,new Map,new Map,i,zc,s),o.forEach(u=>{let h=se(a,u.element,new Map);u.postStyleProps.forEach(p=>h.set(p,null))})):(s.push(ac()),o=[]),s.length)throw lc(s);a.forEach((u,h)=>{u.forEach((p,f)=>{u.set(f,this._driver.computeStyle(h,f,ve))})});let l=o.map(u=>{let h=a.get(u.element);return this._buildPlayer(u,new Map,h)}),c=Ue(l);return this._playersById.set(t,c),c.onDestroy(()=>this.destroy(t)),this.players.push(c),c}destroy(t){let e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);let i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){let e=this._playersById.get(t);if(!e)throw cc(t);return e}listen(t,e,i,s){let r=ys(e,"","","");return gs(this._getPlayer(t),i,r,s),()=>{}}command(t,e,i,s){if(i=="register"){this.register(t,s[0]);return}if(i=="create"){let o=s[0]||{};this.create(t,e,o);return}let r=this._getPlayer(t);switch(i){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t);break}}},ao="ng-animate-queued",Kc=".ng-animate-queued",Yn="ng-animate-disabled",Wc=".ng-animate-disabled",Jc="ng-star-inserted",Qc=".ng-star-inserted",Yc=[],So={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Zc={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},me="__ng_removed",Qt=class{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;let i=t&&t.hasOwnProperty("value"),s=i?t.value:t;if(this.value=eu(s),i){let r=t,{value:o}=r,a=lr(r,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){let e=t.params;if(e){let i=this.options.params;Object.keys(e).forEach(s=>{i[s]==null&&(i[s]=e[s])})}}},Kt="void",Zn=new Qt(Kt),ds=class{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,ue(e,this._hostClassName)}listen(t,e,i,s){if(!this._triggers.has(e))throw uc(i,e);if(i==null||i.length==0)throw hc(e);if(!tu(i))throw dc(i,e);let r=se(this._elementListeners,t,[]),o={name:e,phase:i,callback:s};r.push(o);let a=se(this._engine.statesByElement,t,new Map);return a.has(e)||(ue(t,Oi),ue(t,Oi+"-"+e),a.set(e,Zn)),()=>{this._engine.afterFlush(()=>{let l=r.indexOf(o);l>=0&&r.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(t,e){return this._triggers.has(t)?!1:(this._triggers.set(t,e),!0)}_getTrigger(t){let e=this._triggers.get(t);if(!e)throw fc(t);return e}trigger(t,e,i,s=!0){let r=this._getTrigger(e),o=new Yt(this.id,e,t),a=this._engine.statesByElement.get(t);a||(ue(t,Oi),ue(t,Oi+"-"+e),this._engine.statesByElement.set(t,a=new Map));let l=a.get(e),c=new Qt(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=Zn),!(c.value===Kt)&&l.value===c.value){if(!su(l.params,c.params)){let g=[],v=r.matchStyles(l.value,l.params,g),x=r.matchStyles(c.value,c.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{Ze(t,v),we(t,x)})}return}let p=se(this._engine.playersByElement,t,[]);p.forEach(g=>{g.namespaceId==this.id&&g.triggerName==e&&g.queued&&g.destroy()});let f=r.matchTransition(l.value,c.value,t,c.params),m=!1;if(!f){if(!s)return;f=r.fallbackTransition,m=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:m}),m||(ue(t,ao),o.onStart(()=>{yt(t,ao)})),o.onDone(()=>{let g=this.players.indexOf(o);g>=0&&this.players.splice(g,1);let v=this._engine.playersByElement.get(t);if(v){let x=v.indexOf(o);x>=0&&v.splice(x,1)}}),this.players.push(o),p.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);let e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){let i=this._engine.driver.query(t,Ni,!0);i.forEach(s=>{if(s[me])return;let r=this._engine.fetchNamespacesByElement(s);r.size?r.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,i,s){let r=this._engine.statesByElement.get(t),o=new Map;if(r){let a=[];if(r.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){let u=this.trigger(t,c,Kt,s);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),i&&Ue(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){let e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){let s=new Set;e.forEach(r=>{let o=r.name;if(s.has(o))return;s.add(o);let l=this._triggers.get(o).fallbackTransition,c=i.get(o)||Zn,u=new Qt(Kt),h=new Yt(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(t,e){let i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(i.totalAnimations){let r=i.players.length?i.playersByQueriedElement.get(t):[];if(r&&r.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(i.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)i.markElementAsRemoved(this.id,t,!1,e);else{let r=t[me];(!r||r===So)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){ue(t,this._hostClassName)}drainQueuedTransitions(t){let e=[];return this._queue.forEach(i=>{let s=i.player;if(s.destroyed)return;let r=i.element,o=this._elementListeners.get(r);o&&o.forEach(a=>{if(a.name==i.triggerName){let l=ys(r,i.triggerName,i.fromState.value,i.toState.value);l._data=t,gs(i.player,a.phase,l,a.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(i)}),this._queue=[],e.sort((i,s)=>{let r=i.transition.ast.depCount,o=s.transition.ast.depCount;return r==0||o==0?r-o:this._engine.driver.containsElement(i.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}},fs=class{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,i,s){this.bodyNode=t,this.driver=e,this._normalizer=i,this.scheduler=s,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){let t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){let i=new ds(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){let i=this._namespaceList,s=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(e);for(;a;){let l=s.get(a);if(l){let c=i.indexOf(l);i.splice(c+1,0,t),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(t)}else i.push(t);return s.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let s=this._namespaceLookup[t];s&&s.register(e,i)&&this.totalAnimations++}destroy(t,e){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let i=this._fetchNamespace(t);this.namespacesByHostElement.delete(i.hostElement);let s=this._namespaceList.indexOf(i);s>=0&&this._namespaceList.splice(s,1),i.destroy(e),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){let e=new Set,i=this.statesByElement.get(t);if(i){for(let s of i.values())if(s.namespaceId){let r=this._fetchNamespace(s.namespaceId);r&&e.add(r)}}return e}trigger(t,e,i,s){if(Fi(e)){let r=this._fetchNamespace(t);if(r)return r.trigger(e,i,s),!0}return!1}insertNode(t,e,i,s){if(!Fi(e))return;let r=e[me];if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;let o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){let o=this._fetchNamespace(t);o&&o.insertNode(e,i)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),ue(t,Yn)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),yt(t,Yn))}removeNode(t,e,i){if(Fi(e)){this.scheduler?.notify();let s=t?this._fetchNamespace(t):null;s?s.removeNode(e,i):this.markElementAsRemoved(t,e,!1,i);let r=this.namespacesByHostElement.get(e);r&&r.id!==t&&r.removeNode(e,i)}else this._onRemovalComplete(e,i)}markElementAsRemoved(t,e,i,s,r){this.collectedLeaveElements.push(e),e[me]={namespaceId:t,setForRemoval:s,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:r}}listen(t,e,i,s,r){return Fi(e)?this._fetchNamespace(t).listen(e,i,s,r):()=>{}}_buildInstruction(t,e,i,s,r){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,s,t.fromState.options,t.toState.options,e,r)}destroyInnerAnimations(t){let e=this.driver.query(t,Ni,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(t,ts,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){let e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){let e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Ue(this.players).onDone(()=>t());t()})}processLeaveNode(t){let e=t[me];if(e&&e.setForRemoval){if(t[me]=So,e.namespaceId){this.destroyInnerAnimations(t);let i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(Yn)&&this.markElementAsDisabled(t,!1),this.driver.query(t,Wc,!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,s)=>this._balanceNamespaceList(i,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++){let s=this.collectedEnterElements[i];ue(s,Jc)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let i=[];try{e=this._flushAnimations(i,t)}finally{for(let s=0;s<i.length;s++)i[s]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++){let s=this.collectedLeaveElements[i];this.processLeaveNode(s)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){let i=this._whenQuietFns;this._whenQuietFns=[],e.length?Ue(e).onDone(()=>{i.forEach(s=>s())}):i.forEach(s=>s())}}reportError(t){throw pc(t)}_flushAnimations(t,e){let i=new Jt,s=[],r=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(w=>{u.add(w);let E=this.driver.query(w,Kc,!0);for(let S=0;S<E.length;S++)u.add(E[S])});let h=this.bodyNode,p=Array.from(this.statesByElement.keys()),f=uo(p,this.collectedEnterElements),m=new Map,g=0;f.forEach((w,E)=>{let S=yo+g++;m.set(E,S),w.forEach(M=>ue(M,S))});let v=[],x=new Set,F=new Set;for(let w=0;w<this.collectedLeaveElements.length;w++){let E=this.collectedLeaveElements[w],S=E[me];S&&S.setForRemoval&&(v.push(E),x.add(E),S.hasAnimation?this.driver.query(E,Qc,!0).forEach(M=>x.add(M)):F.add(E))}let N=new Map,I=uo(p,Array.from(x));I.forEach((w,E)=>{let S=es+g++;N.set(E,S),w.forEach(M=>ue(M,S))}),t.push(()=>{f.forEach((w,E)=>{let S=m.get(E);w.forEach(M=>yt(M,S))}),I.forEach((w,E)=>{let S=N.get(E);w.forEach(M=>yt(M,S))}),v.forEach(w=>{this.processLeaveNode(w)})});let W=[],H=[];for(let w=this._namespaceList.length-1;w>=0;w--)this._namespaceList[w].drainQueuedTransitions(e).forEach(S=>{let M=S.player,B=S.element;if(W.push(M),this.collectedEnterElements.length){let J=B[me];if(J&&J.setForMove){if(J.previousTriggersValues&&J.previousTriggersValues.has(S.triggerName)){let ze=J.previousTriggersValues.get(S.triggerName),oe=this.statesByElement.get(S.element);if(oe&&oe.has(S.triggerName)){let Ci=oe.get(S.triggerName);Ci.value=ze,oe.set(S.triggerName,Ci)}}M.destroy();return}}let ye=!h||!this.driver.containsElement(h,B),ie=N.get(B),Ne=m.get(B),L=this._buildInstruction(S,i,Ne,ie,ye);if(L.errors&&L.errors.length){H.push(L);return}if(ye){M.onStart(()=>Ze(B,L.fromStyles)),M.onDestroy(()=>we(B,L.toStyles)),s.push(M);return}if(S.isFallbackTransition){M.onStart(()=>Ze(B,L.fromStyles)),M.onDestroy(()=>we(B,L.toStyles)),s.push(M);return}let ar=[];L.timelines.forEach(J=>{J.stretchStartingKeyframe=!0,this.disabledNodes.has(J.element)||ar.push(J)}),L.timelines=ar,i.append(B,L.timelines);let yl={instruction:L,player:M,element:B};o.push(yl),L.queriedElements.forEach(J=>se(a,J,[]).push(M)),L.preStyleProps.forEach((J,ze)=>{if(J.size){let oe=l.get(ze);oe||l.set(ze,oe=new Set),J.forEach((Ci,xn)=>oe.add(xn))}}),L.postStyleProps.forEach((J,ze)=>{let oe=c.get(ze);oe||c.set(ze,oe=new Set),J.forEach((Ci,xn)=>oe.add(xn))})});if(H.length){let w=[];H.forEach(E=>{w.push(mc(E.triggerName,E.errors))}),W.forEach(E=>E.destroy()),this.reportError(w)}let Q=new Map,ee=new Map;o.forEach(w=>{let E=w.element;i.has(E)&&(ee.set(E,E),this._beforeAnimationBuild(w.player.namespaceId,w.instruction,Q))}),s.forEach(w=>{let E=w.element;this._getPreviousPlayers(E,!1,w.namespaceId,w.triggerName,null).forEach(M=>{se(Q,E,[]).push(M),M.destroy()})});let He=v.filter(w=>ho(w,l,c)),dt=new Map;co(dt,this.driver,F,c,ve).forEach(w=>{ho(w,l,c)&&He.push(w)});let Ge=new Map;f.forEach((w,E)=>{co(Ge,this.driver,new Set(w),l,xi)}),He.forEach(w=>{let E=dt.get(w),S=Ge.get(w);dt.set(w,new Map([...E?.entries()??[],...S?.entries()??[]]))});let kn=[],rr=[],or={};o.forEach(w=>{let{element:E,player:S,instruction:M}=w;if(i.has(E)){if(u.has(E)){S.onDestroy(()=>we(E,M.toStyles)),S.disabled=!0,S.overrideTotalTime(M.totalTime),s.push(S);return}let B=or;if(ee.size>1){let ie=E,Ne=[];for(;ie=ie.parentNode;){let L=ee.get(ie);if(L){B=L;break}Ne.push(ie)}Ne.forEach(L=>ee.set(L,B))}let ye=this._buildAnimation(S.namespaceId,M,Q,r,Ge,dt);if(S.setRealPlayer(ye),B===or)kn.push(S);else{let ie=this.playersByElement.get(B);ie&&ie.length&&(S.parentPlayer=Ue(ie)),s.push(S)}}else Ze(E,M.fromStyles),S.onDestroy(()=>we(E,M.toStyles)),rr.push(S),u.has(E)&&s.push(S)}),rr.forEach(w=>{let E=r.get(w.element);if(E&&E.length){let S=Ue(E);w.setRealPlayer(S)}}),s.forEach(w=>{w.parentPlayer?w.syncPlayerEvents(w.parentPlayer):w.destroy()});for(let w=0;w<v.length;w++){let E=v[w],S=E[me];if(yt(E,es),S&&S.hasAnimation)continue;let M=[];if(a.size){let ye=a.get(E);ye&&ye.length&&M.push(...ye);let ie=this.driver.query(E,ts,!0);for(let Ne=0;Ne<ie.length;Ne++){let L=a.get(ie[Ne]);L&&L.length&&M.push(...L)}}let B=M.filter(ye=>!ye.destroyed);B.length?iu(this,E,B):this.processLeaveNode(E)}return v.length=0,kn.forEach(w=>{this.players.push(w),w.onDone(()=>{w.destroy();let E=this.players.indexOf(w);this.players.splice(E,1)}),w.play()}),kn}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,s,r){let o=[];if(e){let a=this.playersByQueriedElement.get(t);a&&(o=a)}else{let a=this.playersByElement.get(t);if(a){let l=!r||r==Kt;a.forEach(c=>{c.queued||!l&&c.triggerName!=s||o.push(c)})}}return(i||s)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||s&&s!=a.triggerName))),o}_beforeAnimationBuild(t,e,i){let s=e.triggerName,r=e.element,o=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:s;for(let l of e.timelines){let c=l.element,u=c!==r,h=se(i,c,[]);this._getPreviousPlayers(c,u,o,a,e.toState).forEach(f=>{let m=f.getRealPlayer();m.beforeDestroy&&m.beforeDestroy(),f.destroy(),h.push(f)})}Ze(r,e.fromStyles)}_buildAnimation(t,e,i,s,r,o){let a=e.triggerName,l=e.element,c=[],u=new Set,h=new Set,p=e.timelines.map(m=>{let g=m.element;u.add(g);let v=g[me];if(v&&v.removedBeforeQueried)return new $e(m.duration,m.delay);let x=g!==l,F=nu((i.get(g)||Yc).map(Q=>Q.getRealPlayer())).filter(Q=>{let ee=Q;return ee.element?ee.element===g:!1}),N=r.get(g),I=o.get(g),W=fo(this._normalizer,m.keyframes,N,I),H=this._buildPlayer(m,W,F);if(m.subTimeline&&s&&h.add(g),x){let Q=new Yt(t,a,g);Q.setRealPlayer(H),c.push(Q)}return H});c.forEach(m=>{se(this.playersByQueriedElement,m.element,[]).push(m),m.onDone(()=>Xc(this.playersByQueriedElement,m.element,m))}),u.forEach(m=>ue(m,to));let f=Ue(p);return f.onDestroy(()=>{u.forEach(m=>yt(m,to)),we(l,e.toStyles)}),h.forEach(m=>{se(s,m,[]).push(f)}),f}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new $e(t.duration,t.delay)}},Yt=class{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new $e,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(s=>gs(t,i,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){let e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){se(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){let e=this._player;e.triggerCallback&&e.triggerCallback(t)}};function Xc(n,t,e){let i=n.get(t);if(i){if(i.length){let s=i.indexOf(e);i.splice(s,1)}i.length==0&&n.delete(t)}return i}function eu(n){return n??null}function Fi(n){return n&&n.nodeType===1}function tu(n){return n=="start"||n=="done"}function lo(n,t){let e=n.style.display;return n.style.display=t??"none",e}function co(n,t,e,i,s){let r=[];e.forEach(l=>r.push(lo(l)));let o=[];i.forEach((l,c)=>{let u=new Map;l.forEach(h=>{let p=t.computeStyle(c,h,s);u.set(h,p),(!p||p.length==0)&&(c[me]=Zc,o.push(c))}),n.set(c,u)});let a=0;return e.forEach(l=>lo(l,r[a++])),o}function uo(n,t){let e=new Map;if(n.forEach(a=>e.set(a,[])),t.length==0)return e;let i=1,s=new Set(t),r=new Map;function o(a){if(!a)return i;let l=r.get(a);if(l)return l;let c=a.parentNode;return e.has(c)?l=c:s.has(c)?l=i:l=o(c),r.set(a,l),l}return t.forEach(a=>{let l=o(a);l!==i&&e.get(l).push(a)}),e}function ue(n,t){n.classList?.add(t)}function yt(n,t){n.classList?.remove(t)}function iu(n,t,e){Ue(e).onDone(()=>n.processLeaveNode(t))}function nu(n){let t=[];return Co(n,t),t}function Co(n,t){for(let e=0;e<n.length;e++){let i=n[e];i instanceof Gt?Co(i.players,t):t.push(i)}}function su(n,t){let e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let s=0;s<e.length;s++){let r=e[s];if(!t.hasOwnProperty(r)||n[r]!==t[r])return!1}return!0}function ho(n,t,e){let i=e.get(n);if(!i)return!1;let s=t.get(n);return s?i.forEach(r=>s.add(r)):t.set(n,i),e.delete(n),!0}var _t=class{constructor(t,e,i,s){this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new fs(t.body,e,i,s),this._timelineEngine=new hs(t.body,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,i,s,r){let o=t+"-"+s,a=this._triggerCache[o];if(!a){let l=[],c=[],u=wo(this._driver,r,l,c);if(l.length)throw sc(s,l);c.length&&void 0,a=Hc(s,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(e,s,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,s){this._transitionEngine.insertNode(t,e,i,s)}onRemove(t,e,i){this._transitionEngine.removeNode(t,e,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,s){if(i.charAt(0)=="@"){let[r,o]=Xr(i),a=s;this._timelineEngine.command(r,e,o,a)}else this._transitionEngine.trigger(t,e,i,s)}listen(t,e,i,s,r){if(i.charAt(0)=="@"){let[o,a]=Xr(i);return this._timelineEngine.listen(o,e,a,r)}return this._transitionEngine.listen(t,e,i,s,r)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}};function ru(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=Xn(t[0]),t.length>1&&(i=Xn(t[t.length-1]))):t instanceof Map&&(e=Xn(t)),e||i?new ps(n,e,i):null}var ps=class n{static{this.initialStylesByElement=new WeakMap}constructor(t,e,i){this._element=t,this._startStyles=e,this._endStyles=i,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&we(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(we(this._element,this._initialStyles),this._endStyles&&(we(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Ze(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ze(this._element,this._endStyles),this._endStyles=null),we(this._element,this._initialStyles),this._state=3)}};function Xn(n){let t=null;return n.forEach((e,i)=>{ou(i)&&(t=t||new Map,t.set(i,e))}),t}function ou(n){return n==="display"||n==="position"}var qi=class{constructor(t,e,i,s){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map;let e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){let e=[];return t.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(t,e,i){return t.animate(this._convertKeyframesToObject(e),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,s)=>{s!=="offset"&&t.set(s,this._finished?i:bs(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){let e=t==="start"?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}},Hi=class{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return po(t,e)}getParentElement(t){return _s(t)}query(t,e,i){return mo(t,e,i)}computeStyle(t,e,i){return bs(t,e)}animate(t,e,i,s,r,o=[]){let a=s==0?"both":"forwards",l={duration:i,delay:s,fill:a};r&&(l.easing=r);let c=new Map,u=o.filter(f=>f instanceof qi);Ac(i,s)&&u.forEach(f=>{f.currentSnapshot.forEach((m,g)=>c.set(g,m))});let h=Sc(e).map(f=>new Map(f));h=Dc(t,h,c);let p=ru(t,h);return new qi(t,h,l,p)}};var Ri="@",To="@.disabled",Gi=class{constructor(t,e,i,s){this.namespaceId=t,this.delegate=e,this.engine=i,this._onDestroy=s,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,s=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,s){this.delegate.setAttribute(t,e,i,s)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,s){this.delegate.setStyle(t,e,i,s)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){e.charAt(0)==Ri&&e==To?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}},ms=class extends Gi{constructor(t,e,i,s,r){super(e,i,s,r),this.factory=t,this.namespaceId=e}setProperty(t,e,i){e.charAt(0)==Ri?e.charAt(1)=="."&&e==To?(i=i===void 0?!0:!!i,this.disableAnimations(t,i)):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if(e.charAt(0)==Ri){let s=au(t),r=e.slice(1),o="";return r.charAt(0)!=Ri&&([r,o]=lu(r)),this.engine.listen(this.namespaceId,s,r,o,a=>{let l=a._data||-1;this.factory.scheduleListenerCallback(l,i,a)})}return this.delegate.listen(t,e,i)}};function au(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}function lu(n){let t=n.indexOf("."),e=n.substring(0,t),i=n.slice(t+1);return[e,i]}var zi=class{constructor(t,e,i){this.delegate=t,this.engine=e,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(s,r)=>{let o=r?.parentNode(s);o&&r.removeChild(o,s)}}createRenderer(t,e){let i="",s=this.delegate.createRenderer(t,e);if(!t||!e?.data?.animation){let c=this._rendererCache,u=c.get(s);if(!u){let h=()=>c.delete(s);u=new Gi(i,s,this.engine,h),c.set(s,u)}return u}let r=e.id,o=e.id+"-"+this._currentId;this._currentId++,this.engine.register(o,t);let a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(r,o,t,c.name,c)};return e.data.animation.forEach(a),new ms(this,o,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,i){if(t>=0&&t<this._microtaskId){this._zone.run(()=>e(i));return}let s=this._animationCallbacksBuffer;s.length==0&&queueMicrotask(()=>{this._zone.run(()=>{s.forEach(r=>{let[o,a]=r;o(a)}),this._animationCallbacksBuffer=[]})}),s.push([e,i])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var uu=(()=>{class n extends _t{constructor(e,i,s){super(e,i,s,Te(_r,{optional:!0}))}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(i){return new(i||n)(_e(Ht),_e(Xe),_e(et))}}static{this.\u0275prov=fe({token:n,factory:n.\u0275fac})}}return n})();function hu(){return new ji}function du(n,t,e){return new zi(n,t,e)}var Do=[{provide:et,useFactory:hu},{provide:_t,useClass:uu},{provide:wr,useFactory:du,deps:[Rr,_t,Lt]}],Ao=[{provide:Xe,useFactory:()=>new Hi},{provide:In,useValue:"BrowserAnimations"},...Do],fu=[{provide:Xe,useClass:vs},{provide:In,useValue:"NoopAnimations"},...Do],ko=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?fu:Ao}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=pt({type:n})}static{this.\u0275inj=ft({providers:Ao,imports:[Vr]})}}return n})();var Vo=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static{this.\u0275fac=function(i){return new(i||n)(O(Fn),O(mt))}}static{this.\u0275dir=le({type:n})}}return n})(),pu=(()=>{class n extends Vo{static{this.\u0275fac=(()=>{let e;return function(s){return(e||(e=On(n)))(s||n)}})()}static{this.\u0275dir=le({type:n,features:[Le]})}}return n})(),jo=new je("");var mu={provide:jo,useExisting:Rt(()=>Be),multi:!0};function gu(){let n=$n()?$n().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var yu=new je(""),Be=(()=>{class n extends Vo{constructor(e,i,s){super(e,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!gu())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static{this.\u0275fac=function(i){return new(i||n)(O(Fn),O(mt),O(yu,8))}}static{this.\u0275dir=le({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&$("input",function(o){return s._handleInput(o.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(o){return s._compositionEnd(o.target.value)})},features:[qt([mu]),Le]})}}return n})();function _u(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var Cs=new je(""),Lo=new je("");function vu(n){return _u(n.value)?{required:!0}:null}function xo(n){return null}function $o(n){return n!=null}function Uo(n){return Dr(n)?ur(n):n}function Bo(n){let t={};return n.forEach(e=>{t=e!=null?j(j({},t),e):t}),Object.keys(t).length===0?null:t}function qo(n,t){return t.map(e=>e(n))}function wu(n){return!n.validate}function Ho(n){return n.map(t=>wu(t)?t:e=>t.validate(e))}function bu(n){if(!n)return null;let t=n.filter($o);return t.length==0?null:function(e){return Bo(qo(e,t))}}function Ts(n){return n!=null?bu(Ho(n)):null}function Eu(n){if(!n)return null;let t=n.filter($o);return t.length==0?null:function(e){let i=qo(e,t).map(Uo);return dr(i).pipe(hr(Bo))}}function As(n){return n!=null?Eu(Ho(n)):null}function Mo(n,t){return n===null?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Su(n){return n._rawValidators}function Cu(n){return n._rawAsyncValidators}function Ss(n){return n?Array.isArray(n)?n:[n]:[]}function Wi(n,t){return Array.isArray(n)?n.includes(t):n===t}function Oo(n,t){let e=Ss(t);return Ss(n).forEach(s=>{Wi(e,s)||e.push(s)}),e}function Io(n,t){return Ss(t).filter(e=>!Wi(n,e))}var Ji=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Ts(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=As(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},wt=class extends Ji{get formDirective(){return null}get path(){return null}},ti=class extends Ji{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Qi=class{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},Tu={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},qd=ae(j({},Tu),{"[class.ng-submitted]":"isSubmitted"}),bt=(()=>{class n extends Qi{constructor(e){super(e)}static{this.\u0275fac=function(i){return new(i||n)(O(ti,2))}}static{this.\u0275dir=le({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Rn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Le]})}}return n})(),Go=(()=>{class n extends Qi{constructor(e){super(e)}static{this.\u0275fac=function(i){return new(i||n)(O(wt,10))}}static{this.\u0275dir=le({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Rn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Le]})}}return n})();var Zt="VALID",Ki="INVALID",vt="PENDING",Xt="DISABLED";function zo(n){return(Xi(n)?n.validators:n)||null}function Au(n){return Array.isArray(n)?Ts(n):n||null}function Ko(n,t){return(Xi(t)?t.asyncValidators:n)||null}function Du(n){return Array.isArray(n)?As(n):n||null}function Xi(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function ku(n,t,e){let i=n.controls;if(!(t?Object.keys(i):i).length)throw new k(1e3,"");if(!i[e])throw new k(1001,"")}function xu(n,t,e){n._forEachChild((i,s)=>{if(e[s]===void 0)throw new k(1002,"")})}var Yi=class{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Zt}get invalid(){return this.status===Ki}get pending(){return this.status==vt}get disabled(){return this.status===Xt}get enabled(){return this.status!==Xt}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(Oo(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Oo(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Io(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Io(t,this._rawAsyncValidators))}hasValidator(t){return Wi(this._rawValidators,t)}hasAsyncValidator(t){return Wi(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=vt,t.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Xt,this.errors=null,this._forEachChild(i=>{i.disable(ae(j({},t),{onlySelf:!0}))}),this._updateValue(),t.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ae(j({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Zt,this._forEachChild(i=>{i.enable(ae(j({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(ae(j({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Zt||this.status===vt)&&this._runAsyncValidator(t.emitEvent)),t.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Xt:Zt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=vt,this._hasOwnPendingAsyncValidator=!0;let e=Uo(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,s)=>i&&i._find(s),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new jt,this.statusChanges=new jt}_calculateStatus(){return this._allControlsDisabled()?Xt:this.errors?Ki:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vt)?vt:this._anyControlsHaveStatus(Ki)?Ki:Zt}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Xi(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=Au(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=Du(this._rawAsyncValidators)}},Zi=class extends Yi{constructor(t,e,i){super(zo(e),Ko(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){xu(this,!0,t),Object.keys(t).forEach(i=>{ku(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(i=>{let s=this.controls[i];s&&s.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,s)=>{i.reset(t?t[s]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>i._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,i,s)=>((i.enabled||this.disabled)&&(e[s]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((s,r)=>{i=e(i,s,r)}),i}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var Ds=new je("CallSetDisabledState",{providedIn:"root",factory:()=>ks}),ks="always";function Mu(n,t){return[...t.path,n]}function Wo(n,t,e=ks){Jo(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(n.disabled),Iu(n,t),Fu(n,t),Pu(n,t),Ou(n,t)}function Po(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Ou(n,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}function Jo(n,t){let e=Su(n);t.validator!==null?n.setValidators(Mo(e,t.validator)):typeof e=="function"&&n.setValidators([e]);let i=Cu(n);t.asyncValidator!==null?n.setAsyncValidators(Mo(i,t.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let s=()=>n.updateValueAndValidity();Po(t._rawValidators,s),Po(t._rawAsyncValidators,s)}function Iu(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Qo(n,t)})}function Pu(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Qo(n,t),n.updateOn!=="submit"&&n.markAsTouched()})}function Qo(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Fu(n,t){let e=(i,s)=>{t.valueAccessor.writeValue(i),s&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}function Ru(n,t){n==null,Jo(n,t)}function Nu(n,t){if(!n.hasOwnProperty("model"))return!1;let e=n.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function Vu(n){return Object.getPrototypeOf(n.constructor)===pu}function ju(n,t){n._syncPendingControls(),t.forEach(e=>{let i=e.control;i.updateOn==="submit"&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function Lu(n,t){if(!t)return null;Array.isArray(t);let e,i,s;return t.forEach(r=>{r.constructor===Be?e=r:Vu(r)?i=r:s=r}),s||i||e||null}var $u={provide:wt,useExisting:Rt(()=>xs)},ei=Promise.resolve(),xs=(()=>{class n extends wt{constructor(e,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new jt,this.form=new Zi({},Ts(e),As(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){ei.then(()=>{let i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Wo(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){ei.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){ei.then(()=>{let i=this._findContainer(e.path),s=new Zi({});Ru(s,e),i.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){ei.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){ei.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,ju(this.form,this._directives),this.ngSubmit.emit(e),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static{this.\u0275fac=function(i){return new(i||n)(O(Cs,10),O(Lo,10),O(Ds,8))}}static{this.\u0275dir=le({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&$("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{options:[Nt.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[qt([$u]),Le]})}}return n})();function Fo(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function Ro(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Uu=class extends Yi{constructor(t=null,e,i){super(zo(e),Ko(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Xi(e)&&(e.nonNullable||e.initialValueIsDefault)&&(Ro(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Fo(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Fo(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){Ro(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var Bu={provide:ti,useExisting:Rt(()=>tt)},No=Promise.resolve(),tt=(()=>{class n extends ti{constructor(e,i,s,r,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new Uu,this._registered=!1,this.name="",this.update=new jt,this._parent=e,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=Lu(this,r)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),Nu(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Wo(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){No.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,s=i!==0&&Ln(i);No.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Mu(e,this._parent):[e]}static{this.\u0275fac=function(i){return new(i||n)(O(wt,9),O(Cs,10),O(Lo,10),O(jo,10),O(kr,8),O(Ds,8))}}static{this.\u0275dir=le({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Nt.None,"disabled","isDisabled"],model:[Nt.None,"ngModel","model"],options:[Nt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[qt([Bu]),Le,Mn]})}}return n})(),Yo=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=le({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var qu=(()=>{class n{constructor(){this._validator=xo}ngOnChanges(e){if(this.inputName in e){let i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):xo,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=le({type:n,features:[Mn]})}}return n})();var Hu={provide:Cs,useExisting:Rt(()=>Ms),multi:!0};var Ms=(()=>{class n extends qu{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Ln,this.createValidator=e=>vu}enabled(e){return e}static{this.\u0275fac=(()=>{let e;return function(s){return(e||(e=On(n)))(s||n)}})()}static{this.\u0275dir=le({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Ae("required",s._enabled?"":null)},inputs:{required:"required"},features:[qt([Hu]),Le]})}}return n})();var Gu=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=pt({type:n})}static{this.\u0275inj=ft({})}}return n})();var Et=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:Ds,useValue:e.callSetDisabledState??ks}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=pt({type:n})}static{this.\u0275inj=ft({imports:[Gu]})}}return n})();var Zo=(()=>{class n{constructor(){this.mail="",this.password=""}login(){console.log("Username:",this.mail),console.log("Password);",this.password)}autocompletar(){this.mail="mail.com",this.password="1234"}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Y({type:n,selectors:[["app-login"]],standalone:!0,features:[X],decls:20,vars:2,consts:[[1,"container","mt-5"],[1,"row","justify-content-center"],[1,"col-md-4"],[1,"card","shadow","rounded-3"],[1,"card-body"],[1,"card-title","text-center","mb-4"],[1,"mb-3"],["for","mail",1,"form-label"],["type","email","id","mail","placeholder","ejemplo@mail.com",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","placeholder","Contrase\xF1a",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-grid","gap-2"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"]],template:function(i,s){i&1&&(_(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),b(6,"Iniciar Sesi\xF3n"),y(),_(7,"div",6)(8,"label",7),b(9,"Correo electr\xF3nico"),y(),_(10,"input",8),Oe("ngModelChange",function(o){return Me(s.mail,o)||(s.mail=o),o}),y()(),_(11,"div",6)(12,"label",9),b(13,"Contrase\xF1a"),y(),_(14,"input",10),Oe("ngModelChange",function(o){return Me(s.password,o)||(s.password=o),o}),y()(),_(15,"div",11)(16,"button",12),$("click",function(){return s.login()}),b(17,"Login"),y(),_(18,"button",13),$("click",function(){return s.autocompletar()}),b(19,"Auto"),y()()()()()()()),i&2&&(C(10),xe("ngModel",s.mail),C(4),xe("ngModel",s.password))},dependencies:[Et,Be,bt,tt]})}}return n})();var Xo=(()=>{class n{transform(e,i){return i?e.filter(s=>s.nombre.toLowerCase().includes(i.toLowerCase())):e}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275pipe=fr({name:"juegoFiltro",type:n,pure:!0,standalone:!0})}}return n})();var Ku=["ultimoMensaje"];function Wu(n,t){if(n&1){let e=ce();_(0,"button",12),$("click",function(){G(e);let s=R();return z(s.filtro="")}),b(1," \xD7 "),y()}}function Ju(n,t){if(n&1){let e=ce();_(0,"div",21)(1,"p",22),b(2),y(),_(3,"button",23),$("click",function(s){return G(e),R(2).jugar(),z(s.stopPropagation())}),b(4,"Jugar"),y()()}if(n&2){let e=R().$implicit;C(2),Bt(e.descripcion)}}function Qu(n,t){if(n&1){let e=ce();_(0,"div",13)(1,"div",14),$("click",function(){let s=G(e).$implicit,r=R();return z(r.seleccionarJuego(s))}),_(2,"div",15),q(3,"img",16),y(),_(4,"div",17)(5,"h5",18),q(6,"i",19),b(7),y(),Z(8,Ju,5,1,"div",20),y()()()}if(n&2){let e=t.$implicit,i=R();C(3),Er("alt",e.nombre),P("src",i.getImagen(e),yr),C(3),P("ngClass",e.icono),C(),ke(" ",e.nombre," "),C(),P("ngIf",i.juegoSeleccionado===e)}}function Yu(n,t){if(n&1&&(_(0,"div")(1,"div",31)(2,"div")(3,"strong"),b(4),y()(),_(5,"div"),b(6),y(),_(7,"small",32),b(8),Ke(9,"date"),y()(),q(10,"hr",33)(11,"div",null,0),y()),n&2){let e=t.$implicit,i=t.index,s=R(2);C(4),Bt(e.usuario),C(2),Bt(e.texto),C(2),Bt(jn(9,4,e.fecha,"short")),C(3),Ae("data-ultimo",i===s.mensajesOrdenados.length-1?!0:null)}}function Zu(n,t){if(n&1){let e=ce();_(0,"div",24)(1,"div",25)(2,"strong"),b(3,"Chat"),y(),_(4,"button",26),$("click",function(){G(e);let s=R();return z(s.mostrarChat=!1)}),y()(),_(5,"div",27),Z(6,Yu,13,7,"div",28),y(),_(7,"div",29)(8,"input",30),Oe("ngModelChange",function(s){G(e);let r=R();return Me(r.nuevoMensaje,s)||(r.nuevoMensaje=s),z(s)}),$("keyup.enter",function(){G(e);let s=R();return z(s.enviarMensaje())}),y()()()}if(n&2){let e=R();C(6),P("ngForOf",e.mensajesOrdenados),C(2),xe("ngModel",e.nuevoMensaje)}}var ea=(()=>{class n{constructor(e){this.router=e,this.filtro="",this.juegoSeleccionado=null,this.ahorcado="Adivina la Palabra en 7 o menos intentos, juego clasico de ahorcado.",this.mostrarChat=!1,this.nuevoMensaje="",this.mensajes=[{usuario:"Ana",texto:"Weeeeeeeeeeeenas",fecha:new Date("2025-05-28T10:15:00")},{usuario:"Luis",texto:"Todos bots los de este chat",fecha:new Date("2025-05-28T10:17:00")},{usuario:"Marta",texto:"God el preguntado",fecha:new Date("2025-05-28T10:20:00")},{usuario:"Guido",texto:"A casa pete",fecha:new Date("2025-05-28T10:19:00")}],this.juegos=[{nombre:"Mayor o Menor",ruta:["juegos","MayoryMenor"],descripcion:"Adivina la siguiente carta si es mayor o menor, probemos tu suerte.",icono:"bi-suit-spade-fill"},{nombre:"Preguntado",ruta:["juegos","Preguntado"],descripcion:"Responde correctamente quien es el personaje que aparece.",icono:"bi-question-circle"},{nombre:"Blackjack",ruta:["juegos","Blackjack"],descripcion:"Come puntos y evita fantasmas.",icono:"bi-controller"},{nombre:"Ahorcado",ruta:["juegos","Ahorcado"],descripcion:this.ahorcado,icono:"bi-person-x"}]}seleccionarJuego(e){this.juegoSeleccionado=e}jugar(){this.juegoSeleccionado&&this.router.navigate(this.juegoSeleccionado.ruta)}getImagen(e){return`assets/juegos/${e.nombre.toLowerCase().replace(/\s/g,"")}.png`}get mensajesOrdenados(){return this.mensajes.slice().sort((e,i)=>new Date(e.fecha).getTime()-new Date(i.fecha).getTime())}enviarMensaje(){this.nuevoMensaje.trim()&&(this.mensajes.push({usuario:"T\xFA",texto:this.nuevoMensaje.trim(),fecha:new Date}),this.nuevoMensaje="",this.scrollAlUltimoMensaje())}scrollAlUltimoMensaje(){setTimeout(()=>{let e=this.mensajesRefs.toArray();e.length&&e[e.length-1].nativeElement.scrollIntoView({behavior:"smooth"})},0)}toggleChat(){this.mostrarChat=!this.mostrarChat,this.mostrarChat&&this.scrollAlUltimoMensaje()}static{this.\u0275fac=function(i){return new(i||n)(O(Di))}}static{this.\u0275cmp=Y({type:n,selectors:[["app-bienvenidos"]],viewQuery:function(i,s){if(i&1&&Sr(Ku,5,mt),i&2){let r;Cr(r=Tr())&&(s.mensajesRefs=r)}},standalone:!0,features:[X],decls:18,vars:7,consts:[["ultimoMensaje",""],[1,"container","py-4"],[1,"mb-3","w-50"],[1,"position-relative"],["type","text","placeholder","Buscar juego...",1,"form-control","pe-5",3,"ngModelChange","ngModel"],["type","button","class","btn btn-sm btn-link position-absolute top-50 end-0 translate-middle-y me-2 text-danger","aria-label","Borrar",3,"click",4,"ngIf"],[1,"col-12"],[1,"row","row-cols-1","row-cols-md-2","row-cols-lg-3","g-3"],["class","col",4,"ngFor","ngForOf"],[1,"chat-toggle","position-fixed","bottom-0","end-0","m-4"],["aria-label","Toggle Chat",1,"btn","btn-primary","rounded-circle","shadow",3,"click"],["class","card mt-2 shadow chat-window","style","width: 300px;",4,"ngIf"],["type","button","aria-label","Borrar",1,"btn","btn-sm","btn-link","position-absolute","top-50","end-0","translate-middle-y","me-2","text-danger",3,"click"],[1,"col"],[1,"card","h-100","cursor-pointer","shadow-sm","card-color",3,"click"],[1,"d-flex","align-items-center","justify-content-center","bg-light","rounded-top",2,"height","240px","overflow","hidden"],[2,"max-height","100%","max-width","100%","object-fit","contain",3,"src","alt"],[1,"card-body","px-3","py-2"],[1,"card-title","mb-2"],[1,"bi","me-2",3,"ngClass"],["class","mt-2",4,"ngIf"],[1,"mt-2"],[1,"card-text","small"],[1,"btn","btn-success","w-100","mt-2",3,"click"],[1,"card","mt-2","shadow","chat-window",2,"width","300px"],[1,"card-header","d-flex","justify-content-between","align-items-center"],["type","button","aria-label","Cerrar",1,"btn-close","btn-sm",3,"click"],[1,"card-body","chat-messages",2,"max-height","300px","overflow-y","auto"],[4,"ngFor","ngForOf"],[1,"card-footer","p-2"],["type","text","placeholder","Escribe un mensaje...",1,"form-control","form-control-sm",3,"ngModelChange","keyup.enter","ngModel"],[1,"mb-2"],[1,"text-muted"],[1,"my-1"]],template:function(i,s){i&1&&(_(0,"h1"),b(1," Bienvenidos a la Sala de juegos "),q(2,"br"),b(3,` Disfruta de la experiencia
`),y(),q(4,"hr"),_(5,"div",1)(6,"div",2)(7,"div",3)(8,"input",4),Oe("ngModelChange",function(o){return Me(s.filtro,o)||(s.filtro=o),o}),y(),Z(9,Wu,2,0,"button",5),y()(),_(10,"div",6)(11,"div",7),Z(12,Qu,9,5,"div",8),Ke(13,"juegoFiltro"),y()(),_(14,"div",9)(15,"button",10),$("click",function(){return s.toggleChat()}),b(16," \u{1F4AC} "),y(),Z(17,Zu,9,2,"div",11),y()()),i&2&&(C(8),xe("ngModel",s.filtro),C(),P("ngIf",s.filtro),C(3),P("ngForOf",jn(13,4,s.juegos,s.filtro)),C(5),P("ngIf",s.mostrarChat))},dependencies:[We,Mr,Et,Be,bt,tt,Xo,xr,Ir,Pr],styles:[".card-title[_ngcontent-%COMP%]{text-align:center}.chat-window[_ngcontent-%COMP%]{z-index:1050}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.card-color[_ngcontent-%COMP%]{background-color:#bec060}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 20px #0000001a}"]})}}return n})();var ta=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Y({type:n,selectors:[["app-error"]],standalone:!0,features:[X],decls:2,vars:0,template:function(i,s){i&1&&(_(0,"h1"),b(1,"404 pagina no encontrda"),y())}})}}return n})();var ia=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Y({type:n,selectors:[["app-quien-soy"]],standalone:!0,features:[X],decls:32,vars:0,consts:[[1,"info-wrapper"],["src","../../../assets/imagenes/Mi-foto.jpg","alt","Mi Foto"],["id","info-juego"],[2,"height","1500px"]],template:function(i,s){i&1&&(_(0,"h1"),b(1,"Informacion:"),y(),_(2,"body")(3,"div",0),q(4,"img",1),_(5,"ul")(6,"li")(7,"strong"),b(8,"Nombre:"),y(),b(9," Ivan Matias"),y(),_(10,"li")(11,"strong"),b(12,"Apellido:"),y(),b(13," Cantero"),y(),_(14,"li")(15,"strong"),b(16,"Edad:"),y(),b(17," 25 a\xF1os"),y(),_(18,"li")(19,"strong"),b(20,"Materia:"),y(),b(21," Laboratorio IV"),y(),_(22,"li")(23,"strong"),b(24,"Curso:"),y(),b(25," A341"),y()()(),q(26,"hr"),_(27,"h2"),b(28,"Informaci\xF3n del Juego:"),y(),q(29,"div",2),_(30,"div",3),b(31," No disponible. "),y()())},styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;margin:20px}hr[_ngcontent-%COMP%]{margin:30px 0}.info-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:20px}.info-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px;border-radius:10px;flex-shrink:0}.info-wrapper[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}.info-wrapper[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:15px}']})}}return n})();var na=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-MXHTO7MR.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)};var ii=class extends Error{constructor(t,e="FunctionsError",i){super(t),this.name=e,this.context=i}},en=class extends ii{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},tn=class extends ii{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},nn=class extends ii{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}},Is=function(n){return n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2",n}(Is||{});var Xu=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},ni=class{constructor(t,{headers:e={},customFetch:i,region:s=Is.Any}={}){this.url=t,this.headers=e,this.region=s,this.fetch=na(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var i;return Xu(this,void 0,void 0,function*(){try{let{headers:s,method:r,body:o}=e,a={},{region:l}=e;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));let u=yield this.fetch(`${this.url}/${t}`,{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:c}).catch(m=>{throw new en(m)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new tn(u);if(!u.ok)throw new nn(u);let p=((i=u.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield u.json():p==="application/octet-stream"?f=yield u.blob():p==="text/event-stream"?f=u:p==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}};var ga=_l(ma(),1),{PostgrestClient:ya,PostgrestQueryBuilder:Ef,PostgrestFilterBuilder:Sf,PostgrestTransformBuilder:Cf,PostgrestBuilder:Tf,PostgrestError:hh}=ga.default;var _a="2.11.2";var va={"X-Client-Info":`realtime-js/${_a}`},wa="1.0.0",an=1e4,ba=1e3,Ct=function(n){return n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed",n}(Ct||{}),re=function(n){return n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving",n}(re||{}),he=function(n){return n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token",n}(he||{}),Hs=function(n){return n.websocket="websocket",n}(Hs||{}),it=function(n){return n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed",n}(it||{});var ln=class{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){let e=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,e,i)}_decodeBroadcast(t,e,i){let s=e.getUint8(1),r=e.getUint8(2),o=this.HEADER_LENGTH+2,a=i.decode(t.slice(o,o+s));o=o+s;let l=i.decode(t.slice(o,o+r));o=o+r;let c=JSON.parse(i.decode(t.slice(o,t.byteLength)));return{ref:null,topic:a,event:l,payload:c}}};var Tt=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var V=function(n){return n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange",n}(V||{}),zs=(n,t,e={})=>{var i;let s=(i=e.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(t).reduce((r,o)=>(r[o]=dh(o,n,t,s),r),{})},dh=(n,t,e,i)=>{let s=t.find(a=>a.name===n),r=s?.type,o=e[n];return r&&!i.includes(r)?Ea(r,o):Gs(o)},Ea=(n,t)=>{if(n.charAt(0)==="_"){let e=n.slice(1,n.length);return gh(t,e)}switch(n){case V.bool:return fh(t);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return ph(t);case V.json:case V.jsonb:return mh(t);case V.timestamp:return yh(t);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:return Gs(t);default:return Gs(t)}},Gs=n=>n,fh=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},ph=n=>{if(typeof n=="string"){let t=parseFloat(n);if(!Number.isNaN(t))return t}return n},mh=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},gh=(n,t)=>{if(typeof n!="string")return n;let e=n.length-1,i=n[e];if(n[0]==="{"&&i==="}"){let r,o=n.slice(1,e);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(a=>Ea(t,a))}return n},yh=n=>typeof n=="string"?n.replace(" ","T"):n,cn=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};var At=class{constructor(t,e,i={},s=an){this.channel=t,this.event=e,this.payload=i,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var i;return this._hasReceived(t)&&e((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}};var ui=class n{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let i=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},s=>{let{onJoin:r,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=n.syncState(this.state,s,r,o),this.pendingDiffs.forEach(l=>{this.state=n.syncDiff(this.state,l,r,o)}),this.pendingDiffs=[],a()}),this.channel._on(i.diff,{},s=>{let{onJoin:r,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=n.syncDiff(this.state,s,r,o),a())}),this.onJoin((s,r,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:r,newPresences:o})}),this.onLeave((s,r,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:r,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,i,s){let r=this.cloneDeep(t),o=this.transformState(e),a={},l={};return this.map(r,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{let h=r[c];if(h){let p=u.map(v=>v.presence_ref),f=h.map(v=>v.presence_ref),m=u.filter(v=>f.indexOf(v.presence_ref)<0),g=h.filter(v=>p.indexOf(v.presence_ref)<0);m.length>0&&(a[c]=m),g.length>0&&(l[c]=g)}else a[c]=u}),this.syncDiff(r,{joins:a,leaves:l},i,s)}static syncDiff(t,e,i,s){let{joins:r,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return i||(i=()=>{}),s||(s=()=>{}),this.map(r,(a,l)=>{var c;let u=(c=t[a])!==null&&c!==void 0?c:[];if(t[a]=this.cloneDeep(l),u.length>0){let h=t[a].map(f=>f.presence_ref),p=u.filter(f=>h.indexOf(f.presence_ref)<0);t[a].unshift(...p)}i(a,u,l)}),this.map(o,(a,l)=>{let c=t[a];if(!c)return;let u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[a]=c,s(a,c,l),c.length===0&&delete t[a]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(i=>e(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,i)=>{let s=t[i];return"metas"in s?e[i]=s.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):e[i]=s,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Pe=function(n){return n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR",n}(Pe||{});var hi=class n{constructor(t,e={config:{}},i){this.topic=t,this.params=e,this.socket=i,this.bindings={},this.state=re.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new At(this,he.join,this.params,this.timeout),this.rejoinTimer=new Tt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=re.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=re.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this._on(he.reply,{},(s,r)=>{this._trigger(this._replyEventName(r),s)}),this.presence=new ui(this),this.broadcastEndpointURL=cn(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var i,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:r,presence:o,private:a}}=this.params;this._onError(u=>t?.(Pe.CHANNEL_ERROR,u)),this._onClose(()=>t?.(Pe.CLOSED));let l={},c={broadcast:r,presence:o,postgres_changes:(s=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",h=>d(this,[h],function*({postgres_changes:u}){var p;if(this.socket.setAuth(),u===void 0){t?.(Pe.SUBSCRIBED);return}else{let f=this.bindings.postgres_changes,m=(p=f?.length)!==null&&p!==void 0?p:0,g=[];for(let v=0;v<m;v++){let x=f[v],{filter:{event:F,schema:N,table:I,filter:W}}=x,H=u&&u[v];if(H&&H.event===F&&H.schema===N&&H.table===I&&H.filter===W)g.push(Object.assign(Object.assign({},x),{id:H.id}));else{this.unsubscribe(),t?.(Pe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Pe.SUBSCRIBED);return}})).receive("error",u=>{t?.(Pe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t?.(Pe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(i){return d(this,arguments,function*(t,e={}){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(){return d(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,i){return this._on(t,e,i)}send(i){return d(this,arguments,function*(t,e={}){var s,r;if(!this._canPush()&&t.type==="broadcast"){let{event:o,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{let u=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=e.timeout)!==null&&s!==void 0?s:this.timeout);return yield(r=u.body)===null||r===void 0?void 0:r.cancel(),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,c;let u=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=re.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(he.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{let s=new At(this,he.leave,{},t);s.receive("ok",()=>{e(),i("ok")}).receive("timeout",()=>{e(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_fetchWithTimeout(t,e,i){return d(this,null,function*(){let s=new AbortController,r=setTimeout(()=>s.abort(),i),o=yield this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:s.signal}));return clearTimeout(r),o})}_push(t,e,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new At(this,t,e,i);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,e,i){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,i){var s,r;let o=t.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=he;if(i&&[a,l,c,u].indexOf(o)>=0&&i!==this._joinRef())return;let p=this._onMessage(o,e,i);if(e&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var m,g,v;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(g=f.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(p,i)):(r=this.bindings[o])===null||r===void 0||r.filter(f=>{var m,g,v,x,F,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){let I=f.id,W=(m=f.filter)===null||m===void 0?void 0:m.event;return I&&((g=e.ids)===null||g===void 0?void 0:g.includes(I))&&(W==="*"||W?.toLocaleLowerCase()===((v=e.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{let I=(F=(x=f?.filter)===null||x===void 0?void 0:x.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return I==="*"||I===((N=e?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){let m=p.data,{schema:g,table:v,commit_timestamp:x,type:F,errors:N}=m;p=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:x,eventType:F,new:{},old:{},errors:N}),this._getPayloadRecords(m))}f.callback(p,i)})}_isClosed(){return this.state===re.closed}_isJoined(){return this.state===re.joined}_isJoining(){return this.state===re.joining}_isLeaving(){return this.state===re.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,i){let s=t.toLocaleLowerCase(),r={type:s,filter:e,callback:i};return this.bindings[s]?this.bindings[s].push(r):this.bindings[s]=[r],this}_off(t,e){let i=t.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(s=>{var r;return!(((r=s.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===i&&n.isEqual(s.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let i in t)if(t[i]!==e[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(he.close,{},t)}_onError(t){this._on(he.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=re.joining,this.joinPush.resend(t))}_getPayloadRecords(t){let e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=zs(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=zs(t.columns,t.old_record)),e}};var vh=()=>{},wh=typeof WebSocket<"u",bh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,di=class{constructor(t,e){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=va,this.params={},this.timeout=an,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=vh,this.conn=null,this.sendBuffer=[],this.serializer=new ln,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...a)=>import("./chunk-MXHTO7MR.js").then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${t}/${Hs.websocket}`,this.httpEndpoint=cn(t),e?.transport?this.transport=e.transport:this.transport=null,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);let s=(i=e?.params)===null||i===void 0?void 0:i.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=e?.encode?e.encode:(r,o)=>o(JSON.stringify(r)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Tt(()=>d(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e?.fetch),e?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=e?.worker||!1,this.workerUrl=e?.workerUrl}this.accessToken=e?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(wh){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Ks(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),import("./chunk-B6SUMW3L.js").then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wa}))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(t){return d(this,null,function*(){let e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return d(this,null,function*(){let t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t})}log(t,e,i){this.logger(t,e,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Ct.connecting:return it.Connecting;case Ct.open:return it.Open;case Ct.closing:return it.Closing;default:return it.Closed}}isConnected(){return this.connectionState()===it.Open}channel(t,e={config:{}}){let i=new hi(`realtime:${t}`,e,this);return this.channels.push(i),i}push(t){let{topic:e,event:i,payload:s,ref:r}=t,o=()=>{this.encode(t,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${e} ${i} (${r})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return d(this,null,function*(){let e=t||this.accessToken&&(yield this.accessToken())||this.accessTokenValue;if(e){let i=null;try{i=JSON.parse(atob(e.split(".")[1]))}catch{}if(i&&i.exp&&!(Math.floor(Date.now()/1e3)-i.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`);this.accessTokenValue=e,this.channels.forEach(s=>{e&&s.updateJoinPayload({access_token:e}),s.joinedOnce&&s._isJoined()&&s._push(he.access_token,{access_token:e})})}})}sendHeartbeat(){return d(this,null,function*(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(ba,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}})}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:i,event:s,payload:r,ref:o}=e;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${i} ${s} ${o&&"("+o+")"||""}`,r),this.channels.filter(a=>a._isMember(i)).forEach(a=>a._trigger(s,r,o)),this.stateChangeCallbacks.message.forEach(a=>a(e))})}_onConnOpen(){return d(this,null,function*(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(he.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;let i=t.match(/\?/)?"&":"?",s=new URLSearchParams(e);return`${t}${i}${s}`}_workerObjectUrl(t){let e;if(t)e=t;else{let i=new Blob([bh],{type:"application/javascript"});e=URL.createObjectURL(i)}return e}};var Ks=class{constructor(t,e,i){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ct.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=i.close}};var Dt=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function U(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var un=class extends Dt{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}},nt=class extends Dt{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};var Eh=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},dn=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-MXHTO7MR.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},Sa=()=>Eh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-MXHTO7MR.js")).Response:Response}),hn=n=>{if(Array.isArray(n))return n.map(e=>hn(e));if(typeof n=="function"||n!==Object(n))return n;let t={};return Object.entries(n).forEach(([e,i])=>{let s=e.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));t[s]=hn(i)}),t};var st=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},Ws=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Sh=(n,t,e)=>st(void 0,void 0,void 0,function*(){let i=yield Sa();n instanceof i&&!e?.noResolveJson?n.json().then(s=>{t(new un(Ws(s),n.status||500))}).catch(s=>{t(new nt(Ws(s),s))}):t(new nt(Ws(n),n))}),Ch=(n,t,e,i)=>{let s={method:n,headers:t?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),i&&(s.body=JSON.stringify(i)),Object.assign(Object.assign({},s),e))};function fi(n,t,e,i,s,r){return st(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(e,Ch(t,i,s,r)).then(l=>{if(!l.ok)throw l;return i?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Sh(l,a,i))})})}function kt(n,t,e,i){return st(this,void 0,void 0,function*(){return fi(n,"GET",t,e,i)})}function be(n,t,e,i,s){return st(this,void 0,void 0,function*(){return fi(n,"POST",t,i,s,e)})}function Ca(n,t,e,i,s){return st(this,void 0,void 0,function*(){return fi(n,"PUT",t,i,s,e)})}function Ta(n,t,e,i){return st(this,void 0,void 0,function*(){return fi(n,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),i)})}function fn(n,t,e,i,s){return st(this,void 0,void 0,function*(){return fi(n,"DELETE",t,i,s,e)})}var te=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},Th={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Aa={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},pn=class{constructor(t,e={},i,s){this.url=t,this.headers=e,this.bucketId=i,this.fetch=dn(s)}uploadOrUpdate(t,e,i,s){return te(this,void 0,void 0,function*(){try{let r,o=Object.assign(Object.assign({},Aa),s),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)}),l=o.metadata;typeof Blob<"u"&&i instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),l&&r.append("metadata",this.encodeMetadata(l)),r.append("",i)):typeof FormData<"u"&&i instanceof FormData?(r=i,r.append("cacheControl",o.cacheControl),l&&r.append("metadata",this.encodeMetadata(l))):(r=i,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(a=Object.assign(Object.assign({},a),s.headers));let c=this._removeEmptyFolders(e),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:r,headers:a},o?.duplex?{duplex:o.duplex}:{})),p=yield h.json();return h.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(r){if(U(r))return{data:null,error:r};throw r}})}upload(t,e,i){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,i)})}uploadToSignedUrl(t,e,i,s){return te(this,void 0,void 0,function*(){let r=this._removeEmptyFolders(t),o=this._getFinalPath(r),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l,c=Object.assign({upsert:Aa.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",c.cacheControl)):(l=i,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);let h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),p=yield h.json();return h.ok?{data:{path:r,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(U(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,e){return te(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=Object.assign({},this.headers);e?.upsert&&(s["x-upsert"]="true");let r=yield be(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:s}),o=new URL(this.url+r.url),a=o.searchParams.get("token");if(!a)throw new Dt("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(i){if(U(i))return{data:null,error:i};throw i}})}update(t,e,i){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,i)})}move(t,e,i){return te(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(U(s))return{data:null,error:s};throw s}})}copy(t,e,i){return te(this,void 0,void 0,function*(){try{return{data:{path:(yield be(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(U(s))return{data:null,error:s};throw s}})}createSignedUrl(t,e,i){return te(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),r=yield be(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:e},i?.transform?{transform:i.transform}:{}),{headers:this.headers}),o=i?.download?`&download=${i.download===!0?"":i.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${o}`)},{data:r,error:null}}catch(s){if(U(s))return{data:null,error:s};throw s}})}createSignedUrls(t,e,i){return te(this,void 0,void 0,function*(){try{let s=yield be(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),r=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${r}`):null})),error:null}}catch(s){if(U(s))return{data:null,error:s};throw s}})}download(t,e){return te(this,void 0,void 0,function*(){let s=typeof e?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(e?.transform||{}),o=r?`?${r}`:"";try{let a=this._getFinalPath(t);return{data:yield(yield kt(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(U(a))return{data:null,error:a};throw a}})}info(t){return te(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{let i=yield kt(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:hn(i),error:null}}catch(i){if(U(i))return{data:null,error:i};throw i}})}exists(t){return te(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{return yield Ta(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(U(i)&&i instanceof nt){let s=i.originalError;if([400,404].includes(s?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,e){let i=this._getFinalPath(t),s=[],r=e?.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);let a=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${i}${c}`)}}}remove(t){return te(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(U(e))return{data:null,error:e};throw e}})}list(t,e,i){return te(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},Th),e),{prefix:t||""});return{data:yield be(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},i),error:null}}catch(s){if(U(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){let e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};var Da="2.7.1";var ka={"X-Client-Info":`storage-js/${Da}`};var xt=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},mn=class{constructor(t,e={},i){this.url=t,this.headers=Object.assign(Object.assign({},ka),e),this.fetch=dn(i)}listBuckets(){return xt(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(U(t))return{data:null,error:t};throw t}})}getBucket(t){return xt(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(U(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return xt(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(U(i))return{data:null,error:i};throw i}})}updateBucket(t,e){return xt(this,void 0,void 0,function*(){try{return{data:yield Ca(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(U(i))return{data:null,error:i};throw i}})}emptyBucket(t){return xt(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(U(e))return{data:null,error:e};throw e}})}deleteBucket(t){return xt(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(U(e))return{data:null,error:e};throw e}})}};var pi=class extends mn{constructor(t,e={},i){super(t,e,i)}from(t){return new pn(this.url,this.headers,t,this.fetch)}};var xa="2.49.4";var mi="";typeof Deno<"u"?mi="deno":typeof document<"u"?mi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mi="react-native":mi="node";var Ah={"X-Client-Info":`supabase-js-${mi}/${xa}`},Ma={headers:Ah},Oa={schema:"public"},Ia={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Pa={};Gr();var Dh=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},kh=n=>{let t;return n?t=n:typeof fetch>"u"?t=qr:t=fetch,(...e)=>t(...e)},xh=()=>typeof Headers>"u"?Hr:Headers,Fa=(n,t,e)=>{let i=kh(e),s=xh();return(r,o)=>Dh(void 0,void 0,void 0,function*(){var a;let l=(a=yield t())!==null&&a!==void 0?a:n,c=new s(o?.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),i(r,Object.assign(Object.assign({},o),{headers:c}))})};var Mh=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})};function Ra(n){return n.replace(/\/$/,"")}function Na(n,t){let{db:e,auth:i,realtime:s,global:r}=n,{db:o,auth:a,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},o),e),auth:Object.assign(Object.assign({},a),i),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),r),accessToken:()=>Mh(this,void 0,void 0,function*(){return""})};return n.accessToken?u.accessToken=n.accessToken:delete u.accessToken,u}var gn="2.69.1";var rt=30*1e3,yn=3,_n=yn*rt,Va="http://localhost:9999",ja="supabase.auth.token";var La={"X-Client-Info":`gotrue-js/${gn}`};var gi="X-Supabase-Api-Version",Js={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$a=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ua=6e5;var yi=class extends Error{constructor(t,e,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=i}};function T(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}var vn=class extends yi{constructor(t,e,i){super(t,e,i),this.name="AuthApiError",this.status=e,this.code=i}};function Ba(n){return T(n)&&n.name==="AuthApiError"}var Mt=class extends yi{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}},Ee=class extends yi{constructor(t,e,i,s){super(t,i,s),this.name=e,this.status=i}},de=class extends Ee{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function qa(n){return T(n)&&n.name==="AuthSessionMissingError"}var Ot=class extends Ee{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},ot=class extends Ee{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},at=class extends Ee{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function Ha(n){return T(n)&&n.name==="AuthImplicitGrantRedirectError"}var _i=class extends Ee{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},It=class extends Ee{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}};function wn(n){return T(n)&&n.name==="AuthRetryableFetchError"}var vi=class extends Ee{constructor(t,e,i){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=i}};var Fe=class extends Ee{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};var Ga="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),za=` 	
\r=`.split(""),Oh=(()=>{let n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<za.length;t+=1)n[za[t].charCodeAt(0)]=-2;for(let t=0;t<Ga.length;t+=1)n[Ga[t].charCodeAt(0)]=t;return n})();function Ka(n,t,e){let i=Oh[n];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Qs(n){let t=[],e=o=>{t.push(String.fromCodePoint(o))},i={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},r=o=>{Fh(o,i,e)};for(let o=0;o<n.length;o+=1)Ka(n.charCodeAt(o),s,r);return t.join("")}function Ih(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Ph(n,t){for(let e=0;e<n.length;e+=1){let i=n.charCodeAt(e);if(i>55295&&i<=56319){let s=(i-55296)*1024&65535;i=(n.charCodeAt(e+1)-56320&65535|s)+65536,e+=1}Ih(i,t)}}function Fh(n,t,e){if(t.utf8seq===0){if(n<=127){e(n);return}for(let i=1;i<6;i+=1)if(!(n>>7-i&1)){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function Wa(n){let t=[],e={queue:0,queuedBits:0},i=s=>{t.push(s)};for(let s=0;s<n.length;s+=1)Ka(n.charCodeAt(s),e,i);return new Uint8Array(t)}function Ja(n){let t=[];return Ph(n,e=>t.push(e)),new Uint8Array(t)}function Qa(n){return Math.round(Date.now()/1e3)+n}function Ya(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}var ge=()=>typeof window<"u"&&typeof document<"u",lt={tested:!1,writable:!1},qe=()=>{if(!ge())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(lt.tested)return lt.writable;let n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),lt.tested=!0,lt.writable=!0}catch{lt.tested=!0,lt.writable=!1}return lt.writable};function Za(n){let t={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((s,r)=>{t[r]=s})}catch{}return e.searchParams.forEach((i,s)=>{t[s]=i}),t}var bn=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-MXHTO7MR.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},Xa=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ys=(n,t,e)=>d(void 0,null,function*(){yield n.setItem(t,JSON.stringify(e))}),bi=(n,t)=>d(void 0,null,function*(){let e=yield n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),Ei=(n,t)=>d(void 0,null,function*(){yield n.removeItem(t)}),wi=class n{constructor(){this.promise=new n.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}};wi.promiseConstructor=Promise;function En(n){let t=n.split(".");if(t.length!==3)throw new Fe("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!$a.test(t[i]))throw new Fe("JWT not in base64url format");return{header:JSON.parse(Qs(t[0])),payload:JSON.parse(Qs(t[1])),signature:Wa(t[2]),raw:{header:t[0],payload:t[1]}}}function el(n){return d(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),n)})})}function tl(n,t){return new Promise((i,s)=>{d(this,null,function*(){for(let r=0;r<1/0;r++)try{let o=yield n(r);if(!t(r,null,o)){i(o);return}}catch(o){if(!t(r,o)){s(o);return}}})})}function Rh(n){return("0"+n.toString(16)).substr(-2)}function Nh(){let t=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=e.length,s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*i));return s}return crypto.getRandomValues(t),Array.from(t,Rh).join("")}function Vh(n){return d(this,null,function*(){let e=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-256",e),s=new Uint8Array(i);return Array.from(s).map(r=>String.fromCharCode(r)).join("")})}function jh(n){return d(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;let e=yield Vh(n);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function ct(n,t,e=!1){return d(this,null,function*(){let i=Nh(),s=i;e&&(s+="/PASSWORD_RECOVERY"),yield Ys(n,`${t}-code-verifier`,s);let r=yield jh(i);return[r,i===r?"plain":"s256"]})}var Lh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function il(n){let t=n.headers.get(gi);if(!t||!t.match(Lh))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function nl(n){if(!n)throw new Error("Missing exp claim");let t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function sl(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var $h=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e},ut=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Uh=[502,503,504];function rl(n){return d(this,null,function*(){var t;if(!Xa(n))throw new It(ut(n),0);if(Uh.includes(n.status))throw new It(ut(n),n.status);let e;try{e=yield n.json()}catch(r){throw new Mt(ut(r),r)}let i,s=il(n);if(s&&s.getTime()>=Js["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?i=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(i=e.error_code),i){if(i==="weak_password")throw new vi(ut(e),n.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new de}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0))throw new vi(ut(e),n.status,e.weak_password.reasons);throw new vn(ut(e),n.status||500,i)})}var Bh=(n,t,e,i)=>{let s={method:n,headers:t?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(i),Object.assign(Object.assign({},s),e))};function D(n,t,e,i){return d(this,null,function*(){var s;let r=Object.assign({},i?.headers);r[gi]||(r[gi]=Js["2024-01-01"].name),i?.jwt&&(r.Authorization=`Bearer ${i.jwt}`);let o=(s=i?.query)!==null&&s!==void 0?s:{};i?.redirectTo&&(o.redirect_to=i.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield qh(n,t,e+a,{headers:r,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(l):{data:Object.assign({},l),error:null}})}function qh(n,t,e,i,s,r){return d(this,null,function*(){let o=Bh(t,i,s,r),a;try{a=yield n(e,Object.assign({},o))}catch(l){throw console.error(l),new It(ut(l),0)}if(a.ok||(yield rl(a)),i?.noResolveJson)return a;try{return yield a.json()}catch(l){yield rl(l)}})}function Re(n){var t;let e=null;Hh(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=Qa(n.expires_in)));let i=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:e,user:i},error:null}}function Zs(n){let t=Re(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,i)=>e&&typeof i=="string",!0)&&(t.data.weak_password=n.weak_password),t}function Se(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function ol(n){return{data:n,error:null}}function al(n){let{action_link:t,email_otp:e,hashed_token:i,redirect_to:s,verification_type:r}=n,o=$h(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:e,hashed_token:i,redirect_to:s,verification_type:r},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function ll(n){return n}function Hh(n){return n.access_token&&n.refresh_token&&n.expires_in}var Gh=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e},Pt=class{constructor({url:t="",headers:e={},fetch:i}){this.url=t,this.headers=e,this.fetch=bn(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(t,e="global"){return d(this,null,function*(){try{return yield D(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}inviteUserByEmail(i){return d(this,arguments,function*(t,e={}){try{return yield D(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Se})}catch(s){if(T(s))return{data:{user:null},error:s};throw s}})}generateLink(t){return d(this,null,function*(){try{let{options:e}=t,i=Gh(t,["options"]),s=Object.assign(Object.assign({},i),e);return"newEmail"in i&&(s.new_email=i?.newEmail,delete s.newEmail),yield D(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:al,redirectTo:e?.redirectTo})}catch(e){if(T(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return d(this,null,function*(){try{return yield D(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Se})}catch(e){if(T(e))return{data:{user:null},error:e};throw e}})}listUsers(t){return d(this,null,function*(){var e,i,s,r,o,a,l;try{let c={nextPage:null,lastPage:0,total:0},u=yield D(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&i!==void 0?i:"",per_page:(r=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:""},xform:ll});if(u.error)throw u.error;let h=yield u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{let g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=g}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(T(c))return{data:{users:[]},error:c};throw c}})}getUserById(t){return d(this,null,function*(){try{return yield D(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Se})}catch(e){if(T(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return d(this,null,function*(){try{return yield D(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:Se})}catch(i){if(T(i))return{data:{user:null},error:i};throw i}})}deleteUser(t,e=!1){return d(this,null,function*(){try{return yield D(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:Se})}catch(i){if(T(i))return{data:{user:null},error:i};throw i}})}_listFactors(t){return d(this,null,function*(){try{let{data:e,error:i}=yield D(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:e,error:i}}catch(e){if(T(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return d(this,null,function*(){try{return{data:yield D(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(T(e))return{data:null,error:e};throw e}})}};var cl={getItem:n=>qe()?globalThis.localStorage.getItem(n):null,setItem:(n,t)=>{qe()&&globalThis.localStorage.setItem(n,t)},removeItem:n=>{qe()&&globalThis.localStorage.removeItem(n)}};function Xs(n={}){return{getItem:t=>n[t]||null,setItem:(t,e)=>{n[t]=e},removeItem:t=>{delete n[t]}}}function ul(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var ht={debug:!!(globalThis&&qe()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},Si=class extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}},Sn=class extends Si{};function er(n,t,e){return d(this,null,function*(){ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);let i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),ht.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},s=>d(this,null,function*(){if(s){ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return yield e()}finally{ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(t===0)throw ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Sn(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ht.debug)try{let r=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}})))})}ul();var zh={url:Va,storageKey:ja,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:La,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function hl(n,t,e){return d(this,null,function*(){return yield e()})}var tr=(()=>{class n{constructor(e){var i,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=n.nextInstanceID,n.nextInstanceID+=1,this.instanceID>0&&ge()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let r=Object.assign(Object.assign({},zh),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Pt({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=bn(r.fetch),this.lock=r.lock||hl,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:ge()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=er:this.lock=hl,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:qe()?this.storage=cl:(this.memoryStorage={},this.storage=Xs(this.memoryStorage)):(this.memoryStorage={},this.storage=Xs(this.memoryStorage)),ge()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",o=>d(this,null,function*(){this._debug("received broadcast notification from other tab or client",o),yield this._notifyAllSubscribers(o.data.event,o.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${gn}) ${new Date().toISOString()}`,...e),this}initialize(){return d(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=d(this,null,function*(){return yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return d(this,null,function*(){var e;try{let i=Za(window.location.href),s="none";if(this._isImplicitGrantCallback(i)?s="implicit":(yield this._isPKCECallback(i))&&(s="pkce"),ge()&&this.detectSessionInUrl&&s!=="none"){let{data:r,error:o}=yield this._getSessionFromURL(i,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Ha(o)){let c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return yield this._removeSession(),{error:o}}let{session:a,redirectType:l}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),yield this._saveSession(a),setTimeout(()=>d(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",a):yield this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(i){return T(i)?{error:i}:{error:new Mt("Unexpected error during initialization",i)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return d(this,null,function*(){var i,s,r;try{let o=yield D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(i=e?.options)===null||i===void 0?void 0:i.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:Re}),{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(T(o))return{data:{user:null,session:null},error:o};throw o}})}signUp(e){return d(this,null,function*(){var i,s,r;try{let o;if("email"in e){let{email:h,password:p,options:f}=e,m=null,g=null;this.flowType==="pkce"&&([m,g]=yield ct(this.storage,this.storageKey)),o=yield D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:h,password:p,data:(i=f?.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:m,code_challenge_method:g},xform:Re})}else if("phone"in e){let{phone:h,password:p,options:f}=e;o=yield D(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(s=f?.data)!==null&&s!==void 0?s:{},channel:(r=f?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Re})}else throw new ot("You must provide either an email or phone number and a password");let{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(T(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(e){return d(this,null,function*(){try{let i;if("email"in e){let{email:o,password:a,options:l}=e;i=yield D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Zs})}else if("phone"in e){let{phone:o,password:a,options:l}=e;i=yield D(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Zs})}else throw new ot("You must provide either an email or phone number and a password");let{data:s,error:r}=i;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ot}:(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(i){if(T(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOAuth(e){return d(this,null,function*(){var i,s,r,o;return yield this._handleProviderSignIn(e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(e){return d(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>d(this,null,function*(){return this._exchangeCodeForSession(e)}))})}_exchangeCodeForSession(e){return d(this,null,function*(){let i=yield bi(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(i??"").split("/");try{let{data:o,error:a}=yield D(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Re});if(yield Ei(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Ot}:(o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:r??null}),error:a})}catch(o){if(T(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}})}signInWithIdToken(e){return d(this,null,function*(){try{let{options:i,provider:s,token:r,access_token:o,nonce:a}=e,l=yield D(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Re}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ot}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(i){if(T(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOtp(e){return d(this,null,function*(){var i,s,r,o,a;try{if("email"in e){let{email:l,options:c}=e,u=null,h=null;this.flowType==="pkce"&&([u,h]=yield ct(this.storage,this.storageKey));let{error:p}=yield D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(i=c?.data)!==null&&i!==void 0?i:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){let{phone:l,options:c}=e,{data:u,error:h}=yield D(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:h}}throw new ot("You must provide either an email or phone number.")}catch(l){if(T(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(e){return d(this,null,function*(){var i,s;try{let r,o;"options"in e&&(r=(i=e.options)===null||i===void 0?void 0:i.redirectTo,o=(s=e.options)===null||s===void 0?void 0:s.captchaToken);let{data:a,error:l}=yield D(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:Re});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");let c=a.session,u=a.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(r){if(T(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithSSO(e){return d(this,null,function*(){var i,s,r;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=yield ct(this.storage,this.storageKey)),yield D(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(i=e.options)===null||i===void 0?void 0:i.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:ol})}catch(o){if(T(o))return{data:null,error:o};throw o}})}reauthenticate(){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return d(this,null,function*(){try{return yield this._useSession(e=>d(this,null,function*(){let{data:{session:i},error:s}=e;if(s)throw s;if(!i)throw new de;let{error:r}=yield D(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(T(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return d(this,null,function*(){try{let i=`${this.url}/resend`;if("email"in e){let{email:s,type:r,options:o}=e,{error:a}=yield D(this.fetch,"POST",i,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){let{phone:s,type:r,options:o}=e,{data:a,error:l}=yield D(this.fetch,"POST",i,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new ot("You must provide either an email or phone number and a type")}catch(i){if(T(i))return{data:{user:null,session:null},error:i};throw i}})}getSession(){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return this._useSession(i=>d(this,null,function*(){return i}))}))})}_acquireLock(e,i){return d(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=d(this,null,function*(){return yield s,yield i()});return this.pendingInLock.push(d(this,null,function*(){try{yield r}catch{}})),r}return yield this.lock(`lock:${this.storageKey}`,e,()=>d(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let s=i();for(this.pendingInLock.push(d(this,null,function*(){try{yield s}catch{}})),yield s;this.pendingInLock.length;){let r=[...this.pendingInLock];yield Promise.all(r),this.pendingInLock.splice(0,r.length)}return yield s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return d(this,null,function*(){this._debug("#_useSession","begin");try{let i=yield this.__loadSession();return yield e(i)}finally{this._debug("#_useSession","end")}})}__loadSession(){return d(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,i=yield bi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let s=e.expires_at?e.expires_at*1e3-Date.now()<_n:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,h)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,h))})}return{data:{session:e},error:null}}let{session:r,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return d(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return d(this,null,function*(){try{return e?yield D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Se}):yield this._useSession(i=>d(this,null,function*(){var s,r,o;let{data:a,error:l}=i;if(l)throw l;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new de}:yield D(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0,xform:Se})}))}catch(i){if(T(i))return qa(i)&&(yield this._removeSession(),yield Ei(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:i};throw i}})}updateUser(s){return d(this,arguments,function*(e,i={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._updateUser(e,i)}))})}_updateUser(s){return d(this,arguments,function*(e,i={}){try{return yield this._useSession(r=>d(this,null,function*(){let{data:o,error:a}=r;if(a)throw a;if(!o.session)throw new de;let l=o.session,c=null,u=null;this.flowType==="pkce"&&e.email!=null&&([c,u]=yield ct(this.storage,this.storageKey));let{data:h,error:p}=yield D(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:u}),jwt:l.access_token,xform:Se});if(p)throw p;return l.user=h.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(r){if(T(r))return{data:{user:null},error:r};throw r}})}setSession(e){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return d(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new de;let i=Date.now()/1e3,s=i,r=!0,o=null,{payload:a}=En(e.access_token);if(a.exp&&(s=a.exp,r=s<=i),r){let{session:l,error:c}=yield this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{let{data:l,error:c}=yield this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-i,expires_at:s},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(i){if(T(i))return{data:{session:null,user:null},error:i};throw i}})}refreshSession(e){return d(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return d(this,null,function*(){try{return yield this._useSession(i=>d(this,null,function*(){var s;if(!e){let{data:a,error:l}=i;if(l)throw l;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new de;let{session:r,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(i){if(T(i))return{data:{user:null,session:null},error:i};throw i}})}_getSessionFromURL(e,i){return d(this,null,function*(){try{if(!ge())throw new at("No browser detected.");if(e.error||e.error_description||e.error_code)throw new at(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(i){case"implicit":if(this.flowType==="pkce")throw new _i("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new at("Not a valid implicit grant flow url.");break;default:}if(i==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new _i("No code detected.");let{data:N,error:I}=yield this._exchangeCodeForSession(e.code);if(I)throw I;let W=new URL(window.location.href);return W.searchParams.delete("code"),window.history.replaceState(window.history.state,"",W.toString()),{data:{session:N.session,redirectType:null},error:null}}let{provider_token:s,provider_refresh_token:r,access_token:o,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=e;if(!o||!l||!a||!u)throw new at("No session defined in URL");let h=Math.round(Date.now()/1e3),p=parseInt(l),f=h+p;c&&(f=parseInt(c));let m=f-h;m*1e3<=rt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${p}s`);let g=f-p;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,h);let{data:v,error:x}=yield this._getUser(o);if(x)throw x;let F={provider_token:s,provider_refresh_token:r,access_token:o,expires_in:p,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:F,redirectType:e.type},error:null}}catch(s){if(T(s))return{data:{session:null,redirectType:null},error:s};throw s}})}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}_isPKCECallback(e){return d(this,null,function*(){let i=yield bi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&i)})}signOut(){return d(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return d(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(i=>d(this,null,function*(){var s;let{data:r,error:o}=i;if(o)return{error:o};let a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){let{error:l}=yield this.admin.signOut(a,e);if(l&&!(Ba(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(yield this._removeSession(),yield Ei(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(e){let i=Ya(),s={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,s),d(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){this._emitInitialSession(i)}))}),{data:{subscription:s}}}_emitInitialSession(e){return d(this,null,function*(){return yield this._useSession(i=>d(this,null,function*(){var s,r;try{let{data:{session:o},error:a}=i;if(a)throw a;yield(s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){yield(r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}}))})}resetPasswordForEmail(s){return d(this,arguments,function*(e,i={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=yield ct(this.storage,this.storageKey,!0));try{return yield D(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(a){if(T(a))return{data:null,error:a};throw a}})}getUserIdentities(){return d(this,null,function*(){var e;try{let{data:i,error:s}=yield this.getUser();if(s)throw s;return{data:{identities:(e=i.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}linkIdentity(e){return d(this,null,function*(){var i;try{let{data:s,error:r}=yield this._useSession(o=>d(this,null,function*(){var a,l,c,u,h;let{data:p,error:f}=o;if(f)throw f;let m=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield D(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})}));if(r)throw r;return ge()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if(T(s))return{data:{provider:e.provider,url:null},error:s};throw s}})}unlinkIdentity(e){return d(this,null,function*(){try{return yield this._useSession(i=>d(this,null,function*(){var s,r;let{data:o,error:a}=i;if(a)throw a;return yield D(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})}))}catch(i){if(T(i))return{data:null,error:i};throw i}})}_refreshAccessToken(e){return d(this,null,function*(){let i=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{let s=Date.now();return yield tl(r=>d(this,null,function*(){return r>0&&(yield el(200*Math.pow(2,r-1))),this._debug(i,"refreshing attempt",r),yield D(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Re})}),(r,o)=>{let a=200*Math.pow(2,r);return o&&wn(o)&&Date.now()+a-s<rt})}catch(s){if(this._debug(i,"error",s),T(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(i,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,i){return d(this,null,function*(){let s=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",i,"url",s),ge()&&!i.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}})}_recoverAndRefresh(){return d(this,null,function*(){var e;let i="#_recoverAndRefresh()";this._debug(i,"begin");try{let s=yield bi(this.storage,this.storageKey);if(this._debug(i,"session from storage",s),!this._isValidSession(s)){this._debug(i,"session is not valid"),s!==null&&(yield this._removeSession());return}let r=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<_n;if(this._debug(i,`session has${r?"":" not"} expired with margin of ${_n}s`),r){if(this.autoRefreshToken&&s.refresh_token){let{error:o}=yield this._callRefreshToken(s.refresh_token);o&&(console.error(o),wn(o)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(i,"error",s),console.error(s);return}finally{this._debug(i,"end")}})}_callRefreshToken(e){return d(this,null,function*(){var i,s;if(!e)throw new de;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new wi;let{data:o,error:a}=yield this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new de;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(r,"error",o),T(o)){let a={session:null,error:o};return wn(o)||(yield this._removeSession()),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(r,"end")}})}_notifyAllSubscribers(e,i,s=!0){return d(this,null,function*(){let r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",i,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:i});let o=[],a=Array.from(this.stateChangeEmitters.values()).map(l=>d(this,null,function*(){try{yield l.callback(e,i)}catch(c){o.push(c)}}));if(yield Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(r,"end")}})}_saveSession(e){return d(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,yield Ys(this.storage,this.storageKey,e)})}_removeSession(){return d(this,null,function*(){this._debug("#_removeSession()"),yield Ei(this.storage,this.storageKey),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ge()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(i){console.error("removing visibilitychange callback failed",i)}}_startAutoRefresh(){return d(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),rt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>d(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return d(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return d(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return d(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return d(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>d(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(i=>d(this,null,function*(){let{data:{session:s}}=i;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let r=Math.floor((s.expires_at*1e3-e)/rt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${rt}ms, refresh threshold is ${yn} ticks`),r<=yn&&(yield this._callRefreshToken(s.refresh_token))}))}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof Si)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return d(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!ge()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>d(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return d(this,null,function*(){let i=`#_onVisibilityChanged(${e})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>d(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,i,s){return d(this,null,function*(){let r=[`provider=${encodeURIComponent(i)}`];if(s?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){let[o,a]=yield ct(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(l.toString())}if(s?.queryParams){let o=new URLSearchParams(s.queryParams);r.push(o.toString())}return s?.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`})}_unenroll(e){return d(this,null,function*(){try{return yield this._useSession(i=>d(this,null,function*(){var s;let{data:r,error:o}=i;return o?{data:null,error:o}:yield D(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token})}))}catch(i){if(T(i))return{data:null,error:i};throw i}})}_enroll(e){return d(this,null,function*(){try{return yield this._useSession(i=>d(this,null,function*(){var s,r;let{data:o,error:a}=i;if(a)return{data:null,error:a};let l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=yield D(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((r=c?.totp)===null||r===void 0)&&r.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(i){if(T(i))return{data:null,error:i};throw i}})}_verify(e){return d(this,null,function*(){return this._acquireLock(-1,()=>d(this,null,function*(){try{return yield this._useSession(i=>d(this,null,function*(){var s;let{data:r,error:o}=i;if(o)return{data:null,error:o};let{data:a,error:l}=yield D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})}))}catch(i){if(T(i))return{data:null,error:i};throw i}}))})}_challenge(e){return d(this,null,function*(){return this._acquireLock(-1,()=>d(this,null,function*(){try{return yield this._useSession(i=>d(this,null,function*(){var s;let{data:r,error:o}=i;return o?{data:null,error:o}:yield D(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token})}))}catch(i){if(T(i))return{data:null,error:i};throw i}}))})}_challengeAndVerify(e){return d(this,null,function*(){let{data:i,error:s}=yield this._challenge({factorId:e.factorId});return s?{data:null,error:s}:yield this._verify({factorId:e.factorId,challengeId:i.id,code:e.code})})}_listFactors(){return d(this,null,function*(){let{data:{user:e},error:i}=yield this.getUser();if(i)return{data:null,error:i};let s=e?.factors||[],r=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:r,phone:o},error:null}})}_getAuthenticatorAssuranceLevel(){return d(this,null,function*(){return this._acquireLock(-1,()=>d(this,null,function*(){return yield this._useSession(e=>d(this,null,function*(){var i,s;let{data:{session:r},error:o}=e;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:a}=En(r.access_token),l=null;a.aal&&(l=a.aal);let c=l;((s=(i=r.user.factors)===null||i===void 0?void 0:i.filter(p=>p.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");let h=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}))}))})}fetchJwk(s){return d(this,arguments,function*(e,i={keys:[]}){let r=i.keys.find(l=>l.kid===e);if(r||(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+Ua>Date.now()))return r;let{data:o,error:a}=yield D(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!o.keys||o.keys.length===0)throw new Fe("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),r=o.keys.find(l=>l.kid===e),!r)throw new Fe("No matching signing key found in JWKS");return r})}getClaims(s){return d(this,arguments,function*(e,i={keys:[]}){try{let r=e;if(!r){let{data:g,error:v}=yield this.getSession();if(v||!g.session)return{data:null,error:v};r=g.session.access_token}let{header:o,payload:a,signature:l,raw:{header:c,payload:u}}=En(r);if(nl(a.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){let{error:g}=yield this.getUser(r);if(g)throw g;return{data:{claims:a,header:o,signature:l},error:null}}let h=sl(o.alg),p=yield this.fetchJwk(o.kid,i),f=yield crypto.subtle.importKey("jwk",p,h,!0,["verify"]);if(!(yield crypto.subtle.verify(h,f,l,Ja(`${c}.${u}`))))throw new Fe("Invalid JWT signature");return{data:{claims:a,header:o,signature:l},error:null}}catch(r){if(T(r))return{data:null,error:r};throw r}})}}return n.nextInstanceID=0,n})();var Kh=tr,ir=Kh;var Cn=class extends ir{constructor(t){super(t)}};var Wh=function(n,t,e,i){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,t||[])).next())})},Tn=class{constructor(t,e,i){var s,r,o;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");let a=Ra(t);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;let l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:Oa,realtime:Pa,auth:Object.assign(Object.assign({},Ia),{storageKey:l}),global:Ma},u=Na(i??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=u.global.headers)!==null&&r!==void 0?r:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=Fa(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new ya(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new ni(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new pi(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},i={}){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return Wh(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:i}=yield this.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:s,storageKey:r,flowType:o,lock:a,debug:l},c,u){let h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Cn({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:r,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new di(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,i)=>{this._handleTokenChanged(e,"CLIENT",i?.access_token)})}_handleTokenChanged(t,e,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var An=(n,t,e)=>new Tn(n,t,e);var Ft={production:!0,supabaseUrl:"https://hoozfpascflaomjgffzx.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhvb3pmcGFzY2ZsYW9tamdmZnp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU1Mzk0MzQsImV4cCI6MjA2MTExNTQzNH0.e_zW5Ljyd9-wXrnhcGUVYWmTrEi1JPSRrBeL0v2OH4w"};var Dn=(()=>{class n{constructor(){this.isLoggedIn$=new cr(!1),this.supabase=An(Ft.supabaseUrl,Ft.supabaseKey),this.checkSession()}checkSession(){return d(this,null,function*(){let{data:{session:e}}=yield this.supabase.auth.getSession();this.isLoggedIn$.next(!!e),this.supabase.auth.onAuthStateChange((i,s)=>{this.isLoggedIn$.next(!!s)})})}getSupabase(){return this.supabase}logout(){return d(this,null,function*(){yield this.supabase.auth.signOut()})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=fe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var nr=An(Ft.supabaseUrl,Ft.supabaseKey),fl=(()=>{class n{constructor(e,i,s){this.router=e,this.toastr=i,this.authService=s,this.avatarFile=null,this.mail="",this.password=""}register(){nr.auth.signUp({email:this.mail,password:this.password}).then(({data:e,error:i})=>{i?console.error("Error:",i.message):(console.log("User registered:",e.user),this.saveUserData(e.user))})}saveUserData(e){let i=this.saveFile().then(s=>{s&&nr.from("miTabla").insert([{authId:e.id,email:this.mail,avatarUrl:s.path}]).then(({data:r,error:o})=>{o?console.error("Error:",o.message):(this.authService.isLoggedIn$.next(!0),this.toastr.success("Usuario registrado exitosamente","\xA1\xC9xito!"),this.router.navigate(["/home"]))})})}saveFile(){return d(this,null,function*(){let{data:e,error:i}=yield nr.storage.from("images").upload(`users/${this.avatarFile?.name}`,this.avatarFile,{cacheControl:"3600",upsert:!1});return e})}onFileSelected(e){this.avatarFile=e.target.files[0]}static{this.\u0275fac=function(i){return new(i||n)(O(Di),O(Mi),O(Dn))}}static{this.\u0275cmp=Y({type:n,selectors:[["app-registro"]],standalone:!0,features:[X],decls:20,vars:3,consts:[["registroForm","ngForm"],[1,"container","mt-5"],[1,"card","shadow","rounded","p-4","form-container"],[1,"mb-4","text-center"],[3,"ngSubmit"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","foto",1,"form-label"],["type","file","id","foto",1,"form-control",3,"change"],["type","submit",1,"btn","btn-primary","w-100",3,"disabled"]],template:function(i,s){if(i&1){let r=ce();_(0,"div",1)(1,"div",2)(2,"h2",3),b(3,"Registro"),y(),_(4,"form",4,0),$("ngSubmit",function(){return G(r),z(s.register())}),_(6,"div",5)(7,"label",6),b(8,"Email"),y(),_(9,"input",7),Oe("ngModelChange",function(a){return G(r),Me(s.mail,a)||(s.mail=a),z(a)}),y()(),_(10,"div",5)(11,"label",8),b(12,"Contrase\xF1a"),y(),_(13,"input",9),Oe("ngModelChange",function(a){return G(r),Me(s.password,a)||(s.password=a),z(a)}),y()(),_(14,"div",5)(15,"label",10),b(16,"Foto"),y(),_(17,"input",11),$("change",function(a){return G(r),z(s.onFileSelected(a))}),y()(),_(18,"button",12),b(19," Registrarse "),y()()()()}if(i&2){let r=Ar(5);C(9),xe("ngModel",s.mail),C(4),xe("ngModel",s.password),C(5),P("disabled",!r.form.valid)}},dependencies:[Et,Yo,Be,bt,Go,Ms,tt,xs],styles:[".form-container[_ngcontent-%COMP%]{max-width:500px;margin:auto;background-color:#fff;border:1px solid #dee2e6}input[type=file][_ngcontent-%COMP%]{padding:6px}button[_ngcontent-%COMP%]{transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#004085}"]})}}return n})();var pl=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"login",component:Zo},{path:"home",component:ea},{path:"quien-soy",component:ia},{path:"registro",component:fl},{path:"juegos",loadChildren:()=>import("./chunk-DYXY4XPO.js").then(n=>n.JuegosModule)},{path:"**",component:ta}];var ml={providers:[Br(pl),mr(ko),Yr({positionClass:"toast-bottom-right",timeOut:4e3,progressBar:!0,closeButton:!0}),Fr()]};function Jh(n,t){n&1&&(_(0,"li",7)(1,"a",11),b(2,"Login"),y()())}function Qh(n,t){n&1&&(_(0,"li",7)(1,"a",12),b(2,"Registro"),y()())}function Yh(n,t){if(n&1){let e=ce();_(0,"li",7)(1,"a",13),$("click",function(){G(e);let s=R();return z(s.logout())}),b(2,"Log Out"),y()()}}var gl=(()=>{class n{constructor(e){this.authService=e,this.title="TpLabo",this.menuOpen=!1}toggleMenu(){this.menuOpen=!this.menuOpen}closeMenu(){this.menuOpen=!1}logout(){this.authService.logout()}static{this.\u0275fac=function(i){return new(i||n)(O(Dn))}}static{this.\u0275cmp=Y({type:n,selectors:[["app-root"]],standalone:!0,features:[X],decls:21,vars:9,consts:[[1,"navbar","navbar-expand-lg","navbar-dark","bg-dark"],[1,"container-fluid"],["routerLink","/",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse","justify-content-end"],[1,"navbar-nav"],[1,"nav-item"],["routerLink","home","routerLinkActive","active",1,"nav-link"],["class","nav-item",4,"ngIf"],["routerLink","quien-soy","routerLinkActive","active",1,"nav-link"],["routerLink","login","routerLinkActive","active",1,"nav-link"],["routerLink","registro","routerLinkActive","active",1,"nav-link"],[1,"nav-link",3,"click"]],template:function(i,s){i&1&&(_(0,"nav",0)(1,"div",1)(2,"a",2),b(3,"Home"),y(),_(4,"button",3),q(5,"span",4),y(),_(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),b(10,"Home"),y()(),Z(11,Jh,3,0,"li",9),Ke(12,"async"),Z(13,Qh,3,0,"li",9),Ke(14,"async"),_(15,"li",7)(16,"a",10),b(17,"Qui\xE9n Soy"),y()(),Z(18,Yh,3,0,"li",9),Ke(19,"async"),y()()()(),q(20,"router-outlet")),i&2&&(C(11),P("ngIf",!Ti(12,3,s.authService.isLoggedIn$)),C(2),P("ngIf",!Ti(14,5,s.authService.isLoggedIn$)),C(5),P("ngIf",Ti(19,7,s.authService.isLoggedIn$)))},dependencies:[Lr,Ur,$r,Or,We],styles:['.navbar[_ngcontent-%COMP%]{background-image:url("./media/fondo-nav-CDPKPURI.jpg");background-size:cover;background-position:center}']})}}return n})();Nr(gl,ml).catch(n=>console.error(n));
